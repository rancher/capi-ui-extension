(("undefined"!==typeof self?self:this)["webpackChunkcapi_0_8_3_rc2"]=("undefined"!==typeof self?self:this)["webpackChunkcapi_0_8_3_rc2"]||[]).push([[739],{4796:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,".input-label[data-v-3a9e34e9]{color:var(--input-label);margin-bottom:5px;display:block;width:100%}.input-label .icon-warning[data-v-3a9e34e9]{color:var(--error)}",""]),a["default"]=n},12289:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,".ccvar-highlight-container[data-v-5dd32f20]{margin-top:0;padding-top:0;position:relative;display:flex;justify-content:space-between}.ccvar-highlight-container:not(.toggle) .highlight[data-v-5dd32f20]{padding:20px 0 30px 4em;position:relative}.ccvar-highlight-container:not(.toggle) .highlight .highlight-link[data-v-5dd32f20]{position:absolute;bottom:.5em;right:3px}.ccvar-highlight-container.toggle .left-container[data-v-5dd32f20]{padding-top:10px}.ccvar-highlight-container .left-container[data-v-5dd32f20]{flex-basis:50%}.ccvar-highlight-container .right-container[data-v-5dd32f20]{flex-basis:50%;padding-top:5px;color:var(--disabled-text)}.ccvar-highlight-container.toggle .right-container[data-v-5dd32f20]{flex-basis:150%}.ccvar-highlight-container .header[data-v-5dd32f20]{padding-bottom:1em;display:flex;justify-content:flex-start;align-items:end}.ccvar-highlight-container .header .name[data-v-5dd32f20]{margin-bottom:0}.ccvar-highlight-container .header .type[data-v-5dd32f20]{margin-bottom:0;padding-left:5px}.ccvar-highlight-container .highlight[data-v-5dd32f20]{text-align:end;padding:20px 0 20px 4em}.ccvar-highlight-container .highlight i.icon-toggle[data-v-5dd32f20]{display:block;position:absolute;right:5px;bottom:5px}.ccvar-highlight-container.info i.icon-toggle[data-v-5dd32f20]{color:var(--info)}.ccvar-highlight-container.warning i.icon-warning[data-v-5dd32f20]{color:var(--warning)}.ccvar-highlight-container.open.info .right-container .highlight[data-v-5dd32f20]{padding-right:5px;border-right:1px solid var(--info);background-image:linear-gradient(to left,var(--info-banner-bg),var(--body-bg))}.ccvar-highlight-container.open.warning .right-container .highlight[data-v-5dd32f20]{padding-right:5px;border-right:1px solid var(--warning);background-image:linear-gradient(to left,var(--warning-banner-bg),var(--body-bg))}.ccvar-highlight-container .var-input[data-v-5dd32f20] .labeled-input INPUT{padding-top:0}.ccvar-highlight-container .var-input[data-v-5dd32f20]> .labeled-select .vs__selected-options{height:100%!important}.ccvar-highlight-container .highlight-link[data-v-5dd32f20]{padding-top:10px}",""]),a["default"]=n},29166:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,".ccvariable-group-panel[data-v-c48e8af6]{margin:0 0 20px 20px}.ccvariable-group-panel[data-v-c48e8af6] .group-panel{padding-right:0}.ccvariable-group-panel[data-v-c48e8af6] .group-panel-title{font-size:18px}.machine-group[data-v-c48e8af6]>*{padding:.5em}.machine-group H3[data-v-c48e8af6]{margin:0}.expander[data-v-c48e8af6]{margin-top:5px}.expandee[data-v-c48e8af6]{margin:0 0 0 5%}.expandee .variables-group[data-v-c48e8af6]>*{flex:0 1 50%;max-width:50%}.variables-group[data-v-c48e8af6]{margin-top:10px;display:flex;flex-direction:row;flex-wrap:wrap}.variables-group.no-border[data-v-c48e8af6]{margin-right:-16px}.variables-group>.force-newline[data-v-c48e8af6]{margin:0}.variables-group[data-v-c48e8af6]>*{flex:0 1 50%;margin-bottom:20px;max-width:50%}.variables-group>.wider[data-v-c48e8af6] {flex:0 1 50%;max-width:50%}.variables-group>.widest[data-v-c48e8af6] {margin:0 0 20px 0;flex:0 1 100%;max-width:100%}.variables-group>.depth-1[data-v-c48e8af6] {margin:0 0 20px 5%;flex:0 1 97.5%;max-width:47.5%}.variables-group>.depth-1.wider[data-v-c48e8af6] {flex:0 1 47.5%;max-width:47.5%}.variables-group>.depth-1.widest[data-v-c48e8af6] {flex:0 1 97.5%;max-width:97.5%}.variables-group>.depth-2[data-v-c48e8af6] {margin:0 0 20px 10%;flex:0 1 95%;max-width:45%}.variables-group>.depth-2.widest[data-v-c48e8af6] {flex:0 1 95%;max-width:95%}.variables-group>.force-newline[data-v-c48e8af6]{flex:1 0 100%;max-width:none}",""]),a["default"]=n},76342:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,".container[data-v-45950a2e]{display:grid;grid-template-columns:1fr 1fr 1fr}@media only screen and (max-width:992px){.container[data-v-45950a2e]{grid-template-columns:1fr 1fr}}@media only screen and (max-width:1281px){.container[data-v-45950a2e]{grid-template-columns:1fr}}",""]),a["default"]=n},94579:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,".label[data-v-7407ec5d]{display:flex;flex-direction:column;margin-bottom:10px}.label .text-label[data-v-7407ec5d]{font-size:12px;line-height:18px;color:var(--darker)}.label .value[data-v-7407ec5d]{line-height:18px}",""]),a["default"]=n},39697:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,".cluster-card-container[data-v-2904248b]{display:flex;flex-basis:40%;margin:10px;min-height:100px;padding:10px 20px;height:90%;border:1px solid var(--border);border-radius:var(--border-radius)}.cluster-card-container.selected[data-v-2904248b]{border:2px solid var(--app-rancher-accent)}.cluster-card-container[data-v-2904248b]:hover{box-shadow:0 0 30px var(--shadow);transition:box-shadow .1s ease-in-out;cursor:pointer;text-decoration:none!important}.cluster-card-container.rancher .deploys-os-label[data-v-2904248b],.cluster-card-container.rancher .side-label[data-v-2904248b]{background-color:var(--app-rancher-accent)}.cluster-card-container.rancher .deploys-os-label label[data-v-2904248b],.cluster-card-container.rancher .side-label label[data-v-2904248b]{color:var(--app-rancher-accent-text)}.cluster-card-container.rancher[data-v-2904248b]:hover{border-color:var(--app-rancher-accent)}.cluster-card-container.partner .deploys-os-label[data-v-2904248b],.cluster-card-container.partner .side-label[data-v-2904248b]{background-color:var(--app-partner-accent)}.cluster-card-container.partner .deploys-os-label label[data-v-2904248b],.cluster-card-container.partner .side-label label[data-v-2904248b]{color:var(--app-partner-accent-text)}.cluster-card-container.partner[data-v-2904248b]:hover{border-color:var(--app-partner-accent)}.cluster-card-container .card-wrap[data-v-2904248b]{width:100%}.name[data-v-2904248b]{font-size:16px;font-weight:700;margin-bottom:10px}.description[data-v-2904248b]{font-size:14px;margin-bottom:20px}.container[data-v-2904248b]{display:grid;padding:0;grid-template-columns:1fr 1fr}@media only screen and (max-width:1281px){.container[data-v-2904248b]{grid-template-columns:1fr}}.leftcol[data-v-2904248b]{justify-self:start;margin-right:10px}.rightcol[data-v-2904248b]{justify-self:end}@media only screen and (max-width:1281px){.rightcol[data-v-2904248b]{justify-self:start}}",""]),a["default"]=n},54726:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,".required[data-v-66729100]{color:var(--error)}.version[data-v-66729100]{width:65%}[data-v-66729100] .col-half{margin-right:0;width:50%}[data-v-66729100] .accordion-container{border-radius:5px}@media screen and (max-width:1000px){.row-config[data-v-66729100]{flex-direction:column;width:100%}.col-config[data-v-66729100]{width:100%}}",""]),a["default"]=n},53799:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,"@media screen and (max-width:1100px){.row-cp[data-v-aeee92ae]{flex-direction:column;width:100%}.col-port[data-v-aeee92ae]{width:100%;min-width:120px}.col-host[data-v-aeee92ae]{width:200%;min-width:120px}}",""]),a["default"]=n},31546:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,"@media screen and (min-width:1000px){.row-cp[data-v-32521d48]{width:50%}}@media screen and (max-width:1000px){.row-cp[data-v-32521d48]{flex-direction:column;width:200%}}",""]),a["default"]=n},65704:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,".col-networking[data-v-89f357b2]{width:100%}@media screen and (max-width:1100px){.row-networking[data-v-89f357b2]{flex-direction:column;width:200%}.col-port[data-v-89f357b2]{width:50%;min-width:120px}.col-host[data-v-89f357b2]{min-width:120px}.col-host[data-v-89f357b2],.col-networking[data-v-89f357b2]{width:100%}}",""]),a["default"]=n},12982:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,"@media screen and (max-width:1000px){.row-wi[data-v-03d3bb46]{flex-direction:column;width:100%}.box .row-wi.value.row>.col-long[data-v-03d3bb46],.box .row-wi.value.row>.col-short[data-v-03d3bb46]{width:100%;margin-top:20px}}.box[data-v-03d3bb46]{margin:40px 0 40px 0}.box>.value.row .col-long[data-v-03d3bb46]{width:25%;margin-right:1.12%}.box .remove[data-v-03d3bb46]{align-content:center}",""]),a["default"]=n},15256:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,".credential-container[data-v-9b6a5998]{flex:1 1 100%;display:flex;flex-direction:column}",""]),a["default"]=n},52255:function(e,a,t){"use strict";t.r(a);var l=t(40429),o=t.n(l),r=t(1214),s=t.n(r),n=s()(o());n.push([e.id,".grouped-type{position:relative}.rke-switch{margin-top:-10px;position:absolute;right:0}",""]),a["default"]=n},13089:function(e,a,t){"use strict";t.d(a,{IF:function(){return y},O9:function(){return v},Q3:function(){return b},Vd:function(){return C},l1:function(){return g},qW:function(){return p},tn:function(){return h},wU:function(){return k},z0:function(){return f}});var l=t(3514),o=t.n(l),r=t(92043),s=t(87898),n=t(56158),i=t(24850),c=t(2722),d=t.n(c);const p=function(e,{key:a="Value"},t){const{exclusiveMinimum:l,exclusiveMaximum:o,maxItems:r,maxLength:s,maximum:n,minItems:i,minLength:c,minimum:d,pattern:p,uniqueItems:v,required:h,format:g}=t,b=[];return n&&(o?b.push((t=>Number(t)>=Number(n)?e("validation.exclusiveMaxValue",{key:a,maximum:n}):void 0)):b.push((t=>Number(t)>Number(n)?e("validation.maxValue",{key:a,max:n}):void 0))),void 0!==d&&(l?b.push((t=>Number(t)<=Number(d)?e("validation.exclusiveMinValue",{key:a,minimum:d}):void 0)):b.push((t=>Number(t)<Number(d)?e("validation.minValue",{key:a,min:d}):void 0))),void 0!==c&&b.push((t=>t&&t.length<Number(c)?e("validation.minLength",{key:a,min:c}):void 0)),s&&b.push((t=>t&&t.length>Number(s)?e("validation.maxLength",{key:a,max:s}):void 0)),r&&b.push((t=>t&&t.length>r?e("validation.maxItems",{key:a,maxItems:r}):void 0)),void 0!==i&&b.push((t=>t&&t.length<i?e("validation.minItems",{key:a,minItems:i}):void 0)),p&&b.push(u(e("validation.pattern",{key:a,pattern:p}),new RegExp(p))),g&&m(e,{key:a},g)&&b.push(m(e,{key:a},g)),v&&b.push((t=>t&&t.filter(((e,a)=>t.indexOf(e)!==a)).length?e("validation.uniqueItems",{key:a}):void 0)),h&&b.push((t=>h.find((e=>void 0===t[e]))?e("validation.requiredFields",{key:a,requiredFields:h.toString()}):void 0)),b},u=function(e,a){return t=>t&&!t.match(a)?e:void 0},m=function(e,{key:a="Value"},t){const l=(0,n.A)(e,{key:a}),o=e("validation.stringFormat",{key:a,format:t});switch(t){case"hostname":return e=>l.wildcardHostname(e);case"ipv4":return e=>e&&!(0,r.eH)(e)?o:void 0;case"cidr":return e=>e&&!(0,s.z8)(e)||""===e?o:void 0;case"mac":return e=>e&&!(0,s.iw)(e)?o:void 0;case"uuid":return u(o,/^[0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12}$/i);case"uuid3":return u(o,/^[0-9a-f]{8}-?[0-9a-f]{4}-?3[0-9a-f]{3}-?[0-9a-f]{4}-?[0-9a-f]{12}$/i);case"uuid4":return u(o,/^[0-9a-f]{8}-?[0-9a-f]{4}-?4[0-9a-f]{3}-?[89ab][0-9a-f]{3}-?[0-9a-f]{12}$/i);case"uuid5":return u(o,/^[0-9a-f]{8}-?[0-9a-f]{4}-?5[0-9a-f]{3}-?[89ab][0-9a-f]{3}-?[0-9a-f]{12}$/i);default:return}},v=e=>e||!1===e||!o()(e),h=function(e,a){return t=>{try{if(!t||!t.startsWith("v"))return e("validation.version");const l=i.QQ[a],o=d().parse(t);return l?l.includes(o?.build?.[0])?"":e("validation.version"):o?"":e("validation.version")}catch{return e("validation.version")}}},g=function(e){return m(e,{key:"Host"},"hostname")},b=function(e){return a=>a&&isNaN(a)?e("validation.port"):void 0},f=function(e){return m(e,{key:"Value"},"cidr")},y=function(e){return a=>a&&!a.match(/^https?:\/\/(.*)$/)?e("validation.url"):void 0},k=function(e){return a=>a&&!a.match(/^v(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/)?e("validation.version"):void 0},C=function(e){return a=>a&&!a.match(/^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$/)?e("validation.name"):void 0}},4930:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return bt}});var l=t(9274);const o={key:1};function r(e,a,t,r,s,n){const i=(0,l.resolveComponent)("Loading"),c=(0,l.resolveComponent)("ClusterConfig"),d=(0,l.resolveComponent)("CruResource");return(0,l.openBlock)(),(0,l.createElementBlock)("div",null,[s.loading?((0,l.openBlock)(),(0,l.createBlock)(i,{key:0})):((0,l.openBlock)(),(0,l.createElementBlock)("div",o,[s.preselectedClass?((0,l.openBlock)(),(0,l.createBlock)(c,{key:0,value:t.value,"initial-value":e.initialValue,"live-value":e.liveValue,mode:t.mode,"preselected-class":s.preselectedClass,"cluster-classes":s.clusterClasses,"onUpdate:value":a[0]||(a[0]=e=>n.set(t.value,e.k,e.val))},null,8,["value","initial-value","live-value","mode","preselected-class","cluster-classes"])):((0,l.openBlock)(),(0,l.createBlock)(d,{key:1,mode:t.mode,"validation-passed":!0,resource:t.value,errors:e.errors,"cancel-event":!0,"prevent-enter-submit":!0,class:"create-cluster",onFinish:e.save,onCancel:n.cancel,onError:a[2]||(a[2]=a=>e.errors=a)},{"form-footer":(0,l.withCtx)((()=>a[3]||(a[3]=[(0,l.createElementVNode)("div",null,null,-1)]))),default:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{value:t.value,"initial-value":e.initialValue,"live-value":e.liveValue,mode:t.mode,"cluster-classes":s.clusterClasses,"onUpdate:value":a[1]||(a[1]=e=>n.set(t.value,e.k,e.val))},null,8,["value","initial-value","live-value","mode","cluster-classes"])])),_:1},8,["mode","resource","errors","onFinish","onCancel"]))]))])}var s=t(14220),n=t(76978),i=t(2517),c=t(29822),d=t(17646),p=t(24850);const u={key:0},m={class:"mt-20"},v={class:"mt-30"},h={class:"row mb-20"},g={class:"col col-half mt-20"},b={class:"row row-config"},f={class:"col col-half"},y={class:"row row-config"},k={class:"col col-half"},C={class:"col col-half mt-20"},w={class:"col span-12 mb-20"},V={class:"span-12"},N={key:0,class:"row"},E={key:1,class:"row"};function x(e,a,t,o,r,s){const n=(0,l.resolveComponent)("Loading"),i=(0,l.resolveComponent)("t"),c=(0,l.resolveComponent)("CardGrid"),d=(0,l.resolveComponent)("NameNsDescription"),p=(0,l.resolveComponent)("Checkbox"),x=(0,l.resolveComponent)("LabeledSelect"),B=(0,l.resolveComponent)("LabeledInput"),S=(0,l.resolveComponent)("ClusterClassVariables"),P=(0,l.resolveComponent)("Accordion"),A=(0,l.resolveComponent)("ControlPlaneEndpointSection"),O=(0,l.resolveComponent)("ControlPlaneSection"),$=(0,l.resolveComponent)("NetworkSection"),D=(0,l.resolveComponent)("WorkerItem"),T=(0,l.resolveComponent)("Labels"),R=(0,l.resolveComponent)("CruResource");return r.loading?((0,l.openBlock)(),(0,l.createBlock)(n,{key:0})):((0,l.openBlock)(),(0,l.createBlock)(R,{key:1,mode:t.mode,"show-as-form":!0,resource:t.value,errors:e.errors,"validation-passed":!0,"cancel-event":!0,"done-route":e.doneRoute,"apply-hooks":e.applyHooks,steps:r.addSteps,"component-testid":"capi-cluster-create",onDone:s.done,onError:a[18]||(a[18]=a=>e.errors=a),onFinish:s.saveOverride,onCancel:s.cancel},{stepClusterClass:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{rows:s.clusterClassOptions,"key-field":"id","name-field":"label","side-label-field":"tag",onClicked:s.clickedType},{"no-rows":(0,l.withCtx)((()=>[s.canCreateGitRepos?((0,l.openBlock)(),(0,l.createElementBlock)("div",u,[(0,l.createVNode)(i,{raw:"",k:"capi.exampleClasses.noClass"}),(0,l.createElementVNode)("div",m,[(0,l.createElementVNode)("button",{type:"button",class:"btn role-secondary",onClick:a[0]||(a[0]=(...e)=>s.openRepoModal&&s.openRepoModal(...e))},[(0,l.createVNode)(i,{k:"capi.exampleClasses.addExamples"})])])])):(0,l.createCommentVNode)("",!0)])),_:1},8,["rows","onClicked"])])),stepConfiguration:(0,l.withCtx)((()=>[((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:s.topology.class},[(0,l.createVNode)(P,{class:"mt-20 section-accordion","open-initially":"",title:e.t(`capi.cluster.section.${s.formSections.GENERAL}`)},{default:(0,l.withCtx)((()=>[e.isView?(0,l.createCommentVNode)("",!0):((0,l.openBlock)(),(0,l.createBlock)(d,{key:0,value:t.value,mode:t.mode,namespaced:r.classNamespaceSupported,"namespace-options":r.allNamespaces,"name-label":"cluster.name.label","name-placeholder":"cluster.name.placeholder","description-label":"cluster.description.label","description-placeholder":"cluster.description.placeholder",rules:{name:e.fvGetAndReportPathRules("metadata.name")},"onUpdate:value":a[1]||(a[1]=a=>e.$emit("update:value",{k:"metadata",val:a.metadata}))},null,8,["value","mode","namespaced","namespace-options","rules"])),(0,l.createElementVNode)("div",v,[(0,l.createVNode)(p,{value:r.autoImport,"onUpdate:value":[a[2]||(a[2]=e=>r.autoImport=e),s.enableAutoImport],mode:t.mode,"label-key":"capi.cluster.labels.autoimport.label",disabled:s.clusterIsAlreadyCreated},null,8,["value","mode","disabled","onUpdate:value"])]),(0,l.createElementVNode)("div",h,[(0,l.createElementVNode)("div",g,[s.versionOptions.length?((0,l.openBlock)(),(0,l.createBlock)(x,{key:0,mode:t.mode,value:t.value.spec.topology.version,"label-key":"cluster.kubernetesVersion.label",required:"",searchable:"",taggable:"",rules:e.fvGetAndReportPathRules("spec.topology.version"),options:s.versionOptions,onSelecting:a[3]||(a[3]=a=>e.$emit("update:value",{k:"spec.topology.version",val:a}))},null,8,["mode","value","rules","options"])):((0,l.openBlock)(),(0,l.createBlock)(B,{key:1,value:t.value.spec.topology.version,"onUpdate:value":[a[4]||(a[4]=e=>t.value.spec.topology.version=e),a[5]||(a[5]=a=>e.$emit("update:value",{k:"spec.topology.version",val:a}))],mode:t.mode,"label-key":"cluster.kubernetesVersion.label",required:"",rules:e.fvGetAndReportPathRules("spec.topology.version")},null,8,["value","mode","rules"]))])]),(0,l.createVNode)(S,{"will-open":r.configHighlightOpen,value:s.variables,section:s.formSections.GENERAL,"cluster-class":r.clusterClassObj,"cluster-namespace":t.value.metadata?.namespace,onUpdateVariables:s.setVariables,onValidationPassed:a[6]||(a[6]=e=>r.variableSectionReady.general=e)},null,8,["will-open","value","section","cluster-class","cluster-namespace","onUpdateVariables"])])),_:1},8,["title"]),(0,l.createVNode)(P,{class:"mt-20 section-accordion","open-initially":"",title:e.t(`capi.cluster.section.${s.formSections.CONTROL_PLANE}`)},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",b,[(0,l.createElementVNode)("div",f,[(0,l.createVNode)(A,{value:s.controlPlaneEndpoint,"onUpdate:value":a[7]||(a[7]=e=>s.controlPlaneEndpoint=e),mode:t.mode,rules:{host:e.fvGetAndReportPathRules("spec.controlPlaneEndpoint.host"),port:e.fvGetAndReportPathRules("spec.controlPlaneEndpoint.port")}},null,8,["value","mode","rules"])])]),(0,l.createElementVNode)("div",y,[(0,l.createElementVNode)("div",k,[(0,l.createVNode)(O,{value:s.controlPlane,"onUpdate:value":a[8]||(a[8]=e=>s.controlPlane=e),mode:t.mode,rules:{replicas:e.fvGetAndReportPathRules("spec.topology.controlPlane.replicas")}},null,8,["value","mode","rules"])])]),(0,l.createVNode)(S,{"will-open":r.controlPlaneHighlightOpen,value:s.variables,section:s.formSections.CONTROL_PLANE,"cluster-class":r.clusterClassObj,"cluster-namespace":t.value.metadata?.namespace,onUpdateVariables:s.setVariables,onValidationPassed:a[9]||(a[9]=e=>r.variableSectionReady.controlPlane=e)},null,8,["will-open","value","section","cluster-class","cluster-namespace","onUpdateVariables"])])),_:1},8,["title"]),(0,l.createVNode)(P,{class:"mt-20","open-initially":"",title:e.t(`capi.cluster.section.${s.formSections.NETWORKING}`)},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",C,[(0,l.createVNode)($,{value:s.network,"onUpdate:value":a[10]||(a[10]=e=>s.network=e),mode:t.mode,rules:{serviceDomain:e.fvGetAndReportPathRules("spec.clusterNetwork.serviceDomain"),apiServerPort:e.fvGetAndReportPathRules("spec.clusterNetwork.apiServerPort"),pods:e.fvGetAndReportPathRules("spec.clusterNetwork.pods.cidrBlocks"),services:e.fvGetAndReportPathRules("spec.clusterNetwork.services.cidrBlocks")}},null,8,["value","mode","rules"])]),(0,l.createVNode)(S,{"will-open":r.networkingHighlightOpen,value:s.variables,"cluster-class":r.clusterClassObj,section:s.formSections.NETWORKING,"cluster-namespace":t.value.metadata?.namespace,onValidationPassed:a[11]||(a[11]=e=>r.variableSectionReady.networking=e),onUpdateVariables:s.setVariables},null,8,["will-open","value","cluster-class","section","cluster-namespace","onUpdateVariables"])])),_:1},8,["title"]),(0,l.createVNode)(P,{class:"mt-20 section-accordion","open-initially":"",title:e.t(`capi.cluster.section.${s.formSections.WORKERS}`)},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",w,[(0,l.createVNode)(S,{value:s.variables,section:s.formSections.WORKERS,"cluster-class":r.clusterClassObj,"cluster-namespace":t.value.metadata?.namespace,onUpdateVariables:s.setVariables,onValidationPassed:a[12]||(a[12]=e=>r.variableSectionReady.workers=e)},null,8,["value","section","cluster-class","cluster-namespace","onUpdateVariables"]),(0,l.createElementVNode)("div",V,[s.machineDeploymentOptions?((0,l.openBlock)(),(0,l.createElementBlock)("div",N,[(0,l.createVNode)(D,{value:s.machineDeployments,"onUpdate:value":[a[13]||(a[13]=e=>s.machineDeployments=e),a[14]||(a[14]=a=>e.$emit("update:value",{k:"spec.topology.workers.machineDeployments",val:a}))],"global-variables":s.variables,mode:t.mode,title:e.t("capi.cluster.workers.machineDeployments.title"),"default-add-value":s.defaultDeploymentAddValue,"class-options":s.machineDeploymentOptions,"initial-empty-row":!0,"cluster-class":r.clusterClassObj},null,8,["value","global-variables","mode","title","default-add-value","class-options","cluster-class"])])):(0,l.createCommentVNode)("",!0),s.machinePoolOptions?((0,l.openBlock)(),(0,l.createElementBlock)("div",E,[(0,l.createVNode)(D,{value:s.machinePools,"onUpdate:value":[a[15]||(a[15]=e=>s.machinePools=e),a[16]||(a[16]=a=>e.$emit("update:value",{k:"spec.topology.workers.machinePools",val:a}))],"global-variables":s.variables,mode:t.mode,title:e.t("capi.cluster.workers.machinePools.title"),"default-add-value":s.defaultPoolAddValue,"class-options":s.machinePoolOptions,"initial-empty-row":!0,"cluster-class":r.clusterClassObj},null,8,["value","global-variables","mode","title","default-add-value","class-options","cluster-class"])])):(0,l.createCommentVNode)("",!0)])])])),_:1},8,["title"]),(0,l.createVNode)(S,{value:s.variables,"cluster-class":r.clusterClassObj,"cluster-namespace":t.value.metadata?.namespace,onUpdateVariables:s.setVariables,onValidationPassed:a[17]||(a[17]=e=>r.variableSectionReady.misc=e)},null,8,["value","cluster-class","cluster-namespace","onUpdateVariables"]),(0,l.createVNode)(P,{class:"mt-20 section-accordion",title:e.t(`capi.cluster.section.${s.formSections.LABELS}`)},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(T,{value:t.value,mode:t.mode},null,8,["value","mode"])])),_:1},8,["title"])]))])),_:1},8,["mode","resource","errors","done-route","apply-hooks","steps","onDone","onFinish","onCancel"]))}var B=t(68851),S=t(52715),P=t(60046),A=t(77651),O=t(87524),$=t(17537);const D={class:"variables-group"},T={key:1,class:"variables-group no-border"},R={key:1},_={class:"variables-group"},L={key:1,class:"variables-group no-border"};function U(e,a,t,o,r,s){const n=(0,l.resolveComponent)("Variable"),i=(0,l.resolveComponent)("GroupPanel"),c=(0,l.resolveComponent)("Accordion");return s.ownedVariableNames&&s.ownedVariableNames.length?((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:0},(0,l.renderList)(s.groupedVariableDefinitions,((o,d)=>((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:d,class:"var-group"},[t.section||s.isMachineScoped?((0,l.openBlock)(),(0,l.createElementBlock)("div",R,[s.isMachineScoped?((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:0,style:{cursor:"pointer"},class:"expander mt-10",onClick:a[2]||(a[2]=()=>r.expanded=!r.expanded)},[(0,l.createElementVNode)("h4",null,[(0,l.createElementVNode)("i",{class:(0,l.normalizeClass)(["icon text-primary",{"icon-chevron-down":r.expanded,"icon-chevron-up":!r.expanded}])},null,2),(0,l.createTextVNode)((0,l.toDisplayString)(e.t("capi.cluster.variables.overrideDefaults")),1)])])):(0,l.createCommentVNode)("",!0),r.expanded||!s.isMachineScoped?((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:1,class:(0,l.normalizeClass)({expandee:r.expanded})},[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o,((o,c)=>((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:c},["misc"!==c?((0,l.openBlock)(),(0,l.createBlock)(i,{key:0,class:"ccvariable-group-panel",label:c},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",_,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o,((i,c)=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:`${i.name}`},[(0,l.createVNode)(n,{ref_for:!0,ref:`${i.name}-input`,"all-definitions":s.variableDefinitions,"will-open":t.willOpen,"all-variables":t.value,variable:i,value:s.valueFor(i),"is-machine-scoped":s.isMachineScoped,"global-variables":t.globalVariables,"validate-required":!s.isMachineScoped,"cluster-namespace":t.clusterNamespace,mode:t.mode,"onUpdate:value":e=>s.updateVariables(e,i),onValidationPassed:s.updateErrors,onError:a[3]||(a[3]=a=>e.$emit("error",a))},null,8,["all-definitions","will-open","all-variables","variable","value","is-machine-scoped","global-variables","validate-required","cluster-namespace","mode","onUpdate:value","onValidationPassed"]),o[c+1]?((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:`${c}-${r.rerenderKey}`,class:"force-newline"})):(0,l.createCommentVNode)("",!0)],64)))),128))])])),_:2},1032,["label"])):((0,l.openBlock)(),(0,l.createElementBlock)("div",L,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o,((i,c)=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:`${i.name}`},[(0,l.createVNode)(n,{ref_for:!0,ref:`${i.name}-input`,"all-definitions":s.variableDefinitions,"will-open":t.willOpen,"global-variables":t.globalVariables,"all-variables":t.value,variable:i,value:s.valueFor(i),"validate-required":!s.isMachineScoped,"is-machine-scoped":s.isMachineScoped,"cluster-namespace":t.clusterNamespace,mode:t.mode,"onUpdate:value":e=>s.updateVariables(e,i),onValidationPassed:s.updateErrors,onError:a[4]||(a[4]=a=>e.$emit("error",a))},null,8,["all-definitions","will-open","global-variables","all-variables","variable","value","validate-required","is-machine-scoped","cluster-namespace","mode","onUpdate:value","onValidationPassed"]),o[c+1]?((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:`${c}-${r.rerenderKey}`,class:"force-newline"})):(0,l.createCommentVNode)("",!0)],64)))),128))]))])))),128))],2)):(0,l.createCommentVNode)("",!0)])):((0,l.openBlock)(),(0,l.createBlock)(c,{key:0,class:(0,l.normalizeClass)(["mt-20",{"machine-group":s.isMachineScoped}]),title:e.withFallback(`capi.variables.${d}`,null,d),"open-initially":!s.isMachineScoped},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o,((o,c)=>((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:c},["misc"!==c?((0,l.openBlock)(),(0,l.createBlock)(i,{key:0,class:"ccvariable-group-panel",label:c},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",D,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o,((i,c)=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:`${i.name}`},[(0,l.createVNode)(n,{ref_for:!0,ref:`${i.name}-input`,"all-definitions":s.variableDefinitions,"will-open":t.willOpen,"all-variables":t.value,variable:i,value:s.valueFor(i),"is-machine-scoped":s.isMachineScoped,"global-variables":t.globalVariables,"validate-required":!e.machineDeploymentClass&&!e.machinePoolClass,"cluster-namespace":t.clusterNamespace,"onUpdate:value":e=>s.updateVariables(e,i),onValidationPassed:s.updateErrors,onError:a[0]||(a[0]=a=>e.$emit("error",a))},null,8,["all-definitions","will-open","all-variables","variable","value","is-machine-scoped","global-variables","validate-required","cluster-namespace","onUpdate:value","onValidationPassed"]),o[c+1]?((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:`${c}-${r.rerenderKey}`,class:"force-newline"})):(0,l.createCommentVNode)("",!0)],64)))),128))])])),_:2},1032,["label"])):((0,l.openBlock)(),(0,l.createElementBlock)("div",T,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o,((i,c)=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:`${i.name}`},[(0,l.createVNode)(n,{ref_for:!0,ref:`${i.name}-input`,"all-definitions":s.variableDefinitions,"will-open":t.willOpen,"global-variables":t.globalVariables,"all-variables":t.value,variable:i,value:s.valueFor(i),"validate-required":!s.isMachineScoped,"is-machine-scoped":s.isMachineScoped,"cluster-namespace":t.clusterNamespace,"onUpdate:value":e=>s.updateVariables(e,i),onValidationPassed:s.updateErrors,onError:a[1]||(a[1]=a=>e.$emit("error",a))},null,8,["all-definitions","will-open","global-variables","all-variables","variable","value","validate-required","is-machine-scoped","cluster-namespace","onUpdate:value","onValidationPassed"]),o[c+1]?((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:`${c}-${r.rerenderKey}`,class:"force-newline"})):(0,l.createCommentVNode)("",!0)],64)))),128))]))])))),128))])),_:2},1032,["class","title","open-initially"]))])))),128)):(0,l.createCommentVNode)("",!0)}var M=t(65359),F=(t(97331),t(92043));const I={key:0,class:"input-label"},q={key:0,class:"text-error"},j={key:0},G={key:1,class:"input-label"},Y={key:0,class:"icon icon-sm icon-info"},H={key:1,class:"icon icon-warning"};function z(e,a,t,o,r,s){const n=(0,l.resolveComponent)("YamlEditor"),i=(0,l.resolveComponent)("VariableHighlight"),c=(0,l.resolveDirective)("clean-tooltip");return s.componentForType?(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:0,class:(0,l.normalizeClass)({wider:s.displayClasses.wider,widest:s.displayClasses.widest,[`${s.componentForType.name}`]:!0,[`${s.displayClasses.depth}`]:!0})},[(0,l.createVNode)(i,{"is-machine-scoped":t.isMachineScoped,mode:t.mode,"variable-def":t.variable,"variable-value":t.value,"will-open":t.willOpen,"is-toggle":s.isToggle},{highlight:(0,l.withCtx)((({toggleOpen:o})=>[s.isYamlComponent?((0,l.openBlock)(),(0,l.createElementBlock)("div",I,[(0,l.createTextVNode)((0,l.toDisplayString)(t.variable.name)+" ",1),t.variable.required?((0,l.openBlock)(),(0,l.createElementBlock)("span",q,"*")):(0,l.createCommentVNode)("",!0)])):(0,l.createCommentVNode)("",!0),s.componentForType?((0,l.openBlock)(),(0,l.createBlock)((0,l.resolveDynamicComponent)(s.componentForType.component),{key:1,id:s.componentForType.name,mode:t.mode,"aria-label":e.withFallback(`capi.variables.${s.label}`,null,s.label),value:s.displayValue,label:s.highlighted?" ":e.withFallback(`capi.variables.${s.label}`,null,s.label),"on-label":s.isToggle?e.withFallback(`capi.variables.${s.label}`,null,s.label):void 0,placeholder:s.placeholder,tooltip:s.tooltip,status:r.annotationError?"warning":null,required:t.variable.required&&!t.isMachineScoped&&!s.highlighted,title:s.highlighted?" ":e.withFallback(`capi.variables.${s.label}`,null,s.label),options:s.variableOptions,rules:s.isListComponent?[]:s.validationRules,type:"number"===s.schema.type||"integer"===s.schema.type?"number":"text","as-map":!0,"resource-type":s.resourceType,"cluster-namespace":t.clusterNamespace,"onUpdate:value":e=>s.setValue(e,o)},(0,l.createSlots)({title:(0,l.withCtx)((()=>[s.highlighted?((0,l.openBlock)(),(0,l.createElementBlock)("div",j,a[0]||(a[0]=[(0,l.createElementVNode)("span",null,null,-1)]))):((0,l.openBlock)(),(0,l.createElementBlock)("div",G,[(0,l.createElementVNode)("span",null,[(0,l.createTextVNode)((0,l.toDisplayString)(e.withFallback(`capi.variables.${s.label}`,null,s.label)||" ")+" ",1),s.schema.description?(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)("i",Y,null,512)),[[c,s.schema.description]]):(0,l.createCommentVNode)("",!0),s.isValid?(0,l.createCommentVNode)("",!0):(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)("i",H,null,512)),[[c,s.validationErrors.join(" ")]])])]))])),_:2},[s.isYamlKeyValueComponent&&r.yamlPlaceholder?{name:"value",fn:(0,l.withCtx)((({queueUpdate:e,row:a})=>[(0,l.createVNode)(n,{value:r.yamlPlaceholder||a,"onUpdate:value":t=>s.setYamlMapValue(t,a,e)},null,8,["value","onUpdate:value"])])),key:"0"}:void 0]),1064,["id","mode","aria-label","value","label","on-label","placeholder","tooltip","status","required","title","options","rules","type","resource-type","cluster-namespace","onUpdate:value"])):(0,l.createCommentVNode)("",!0),a[1]||(a[1]=(0,l.createElementVNode)("div",{class:"flexbox-newline"},null,-1))])),_:1},8,["is-machine-scoped","mode","variable-def","variable-value","will-open","is-toggle"])],2)),[[l.vShow,s.toggled]]):(0,l.createCommentVNode)("",!0)}var K=t(46343),Z=t.n(K),W=t(20246),Q=t.n(W),X=t(99499),J=t(13089),ee=t(52946),ae=t(91578),te=t(55424),le=t(66171),oe=t(78344);const re={class:"row"},se={key:0,class:"col span-6"},ne={class:"col span-6"};function ie(e,a,t,o,r,s){const n=(0,l.resolveComponent)("LabeledSelect");return(0,l.openBlock)(),(0,l.createElementBlock)("div",re,[s.namespaced?((0,l.openBlock)(),(0,l.createElementBlock)("div",se,[(0,l.createVNode)(n,{"label-key":"tableHeaders.namespace",mode:t.mode,value:s.namespace,"option-label":"id",options:s.namespaces||[],searchable:"",taggable:"",rules:t.rules,onSelecting:a[0]||(a[0]=e=>s.namespace=e?.id)},null,8,["mode","value","options","rules"])])):(0,l.createCommentVNode)("",!0),(0,l.createElementVNode)("div",ne,[(0,l.createVNode)(n,{value:s.name,loading:r.loading,"label-key":"tableHeaders.name",options:s.resourceNames||[],mode:t.mode,taggable:"",searchable:"",rules:t.rules,onSelecting:a[1]||(a[1]=e=>s.name=e)},null,8,["value","loading","options","mode","rules"])])])}var ce=t(35664),de=t(4364),pe={name:"ResourceVariableInput",props:{resourceType:{type:String,required:!0},label:{type:String,default:null},value:{type:Object,default:()=>({name:""})},rules:{type:Array,default:()=>[]},mode:{type:String,default:s.YQ},clusterNamespace:{type:String,default:""}},emits:["update:value","validationPassed"],components:{LabeledSelect:O.A},created(){this.fetchResource(this.clusterNamespace)},data(){return{loading:!1,resource:[]}},methods:{async fetchResource(e){this.loading=!0;const a={};this.namespaced&&(a.namespaced=e);try{this.resource=await this.$store.dispatch("management/findAll",{type:this.resourceType,opt:a})}catch(t){de.error(t)}this.loading=!1},update(e=""){const a={name:e};this.namespaced&&(a.namespace=this.namespace),this.$emit("update:value",a)}},computed:{...(0,M.L8)({all:"management/all",schemaFor:"management/schemaFor"}),namespaced(){const e=this.schemaFor(this.resourceType);return!!e&&e?.attributes?.namespaced},namespaces(){return this.all(ce.CU)},resourceNames(){return this.resource.map((e=>e?.metadata?.name||e.id))},name:{get(){return this.value?.name||""},set(e){const a={name:e};this.namespaced&&(a.namespace=this.namespace),this.$emit("update:value",a)}},namespace:{get(){return this.value?.namespace||this.clusterNamespace||""},set(e){const a={namespace:e,name:this.name};this.$emit("update:value",a),this.namespaces.find((a=>a.id===e))&&this.fetchResource(e)}}}},ue=t(47433);const me=(0,ue.A)(pe,[["render",ie]]);var ve=me;const he={TEXT:"text-var",BOOL:"checkbox-var",BOOL_TOGGLE:"toggle-var",MAP:"keyvalue-var",MAP_YAML:"keyvalue-yaml-var",ARRAY:"arraylist-var",YAML:"yamleditor-var",SEARCH_TYPE:"resourcevariable-var"},ge=["string","int","boolean"],be=(e,a)=>!!(a||[]).filter((a=>(a?.metadata?.annotations?.[p.BC.TOGGLED_BY]||"").split(",").map((e=>e.replace(" ",""))).includes(e.name))).length||e.name.includes("toggle"),fe=e=>{const a=e?.schema?.openAPIV3Schema||{},{properties:t={}}=a;return!!e?.metadata?.annotations?.[p.BC.SEARCH_TYPE]&&(t?.name&&"string"===t?.name?.type&&!Object.keys(t).find((e=>"name"!==e&&"namespace"!==e)))},ye=(e,a)=>{let t;const l=e?.schema?.openAPIV3Schema||{};let{type:o}=l;const r=l?.enum&&l?.enum?.length;if(l.additionalProperties&&(o="map"),r)t={component:O.A,name:he.TEXT};else switch(o){case"object":t=fe(e)?{component:ve,name:he.SEARCH_TYPE}:{component:X.A,name:he.YAML};break;case"map":t=l.additionalProperties.properties?{component:te.A,name:he.MAP_YAML}:{component:te.A,name:he.MAP};break;case"array":t=ge.includes(l?.items?.type)?{component:le.A,name:he.ARRAY}:{component:X.A,name:he.YAML};break;case"string":t={component:S.A,name:he.TEXT};break;case"integer":t={component:S.A,name:he.TEXT};break;case"number":t={component:S.A,name:he.TEXT};break;case"boolean":t=be(e,a)?{component:oe.A,name:he.BOOL_TOGGLE}:{component:ae.A,name:he.BOOL};break;default:break}return t},ke=function(e,a="ccvariable"){const t=[];if("array"===e.type&&"ccvariable"===a){const l=(0,F.vx)(),o=(0,F.vx)(),r={id:a,resourceFields:{[l]:{type:"array",subtype:o}}},s={id:o,resourceFields:e?.items?.properties};t.push(r),t.push(s)}else{const l="array"===e.type?e?.items?.properties:e.additionalProperties?.properties||e?.properties,o={id:a,resourceFields:{}};t.push(o);for(const e in l){const a=(0,F.vx)(),r=l[e];if(ge.includes(r.type))o.resourceFields[e]=r;else if("array"===r.type)if(ge.includes(r?.items?.type))o.resourceFields[e]={type:"array",subtype:r.items.type};else{const r=ke(l[e],a);t.push(...r),o.resourceFields[e]={type:"array",subtype:a}}else if(r.additionalProperties)if(ge.includes(r.additionalProperties.type))o.resourceFields[e]={type:"map",subtype:r.additionalProperties.type};else{const r=ke(l[e],a);t.push(...r),o.resourceFields[e]={type:"map",subtype:a}}else{const r=ke(l[e],a);t.push(...r),o.resourceFields[e]={type:a}}}}return t},Ce=function(e,a={}){const t=ke(e),l=(0,ee.mH)(t,"ccvariable",a,!1);if("array"===e.type){const e=l.slice(l.indexOf("\n")+1);return e}return l},we={class:"left-container"},Ve={key:0,class:"header"},Ne={class:"name"},Ee={key:0,class:"text-error"},xe={key:0,class:"type"},Be={key:1},Se={class:"var-input"},Pe={class:"right-container"},Ae={class:"highlight"},Oe={key:0,class:"highlight-link"},$e=["aria-label","href"];function De(e,a,t,o,r,s){const n=(0,l.resolveComponent)("t");return s.showHighlight?((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:0,class:(0,l.normalizeClass)(["ccvar-highlight-container",{open:r.open,closed:!r.open,toggle:t.isToggle,["info"]:"info"===s.highlightColor,["warning"]:"warning"===s.highlightColor,["error"]:"error"===s.highlightColor}])},[(0,l.createElementVNode)("div",we,[t.isToggle?(0,l.createCommentVNode)("",!0):((0,l.openBlock)(),(0,l.createElementBlock)("div",Ve,[(0,l.createElementVNode)("h4",Ne,[(0,l.createTextVNode)((0,l.toDisplayString)(s.displayName)+" ",1),s.required?((0,l.openBlock)(),(0,l.createElementBlock)("span",Ee,"*")):(0,l.createCommentVNode)("",!0)]),s.searchType?((0,l.openBlock)(),(0,l.createElementBlock)("label",xe,(0,l.toDisplayString)(s.searchType),1)):((0,l.openBlock)(),(0,l.createElementBlock)("label",Be)),"warning"===s.highlightColor||"error"===s.highlightColor?((0,l.openBlock)(),(0,l.createElementBlock)("i",{key:2,class:(0,l.normalizeClass)(["icon icon-toggle ml-5",{["icon-warning"]:"warning"===s.highlightColor,["icon-error"]:"error"===s.highlightColor}]),onClick:a[0]||(a[0]=e=>s.toggleOpen(!r.open))},null,2)):(0,l.createCommentVNode)("",!0)])),(0,l.createElementVNode)("div",Se,[(0,l.renderSlot)(e.$slots,"highlight",{toggleOpen:s.toggleOpen},void 0,!0)])]),(0,l.createElementVNode)("div",Pe,[(0,l.withDirectives)((0,l.createElementVNode)("div",Ae,[(0,l.createTextVNode)((0,l.toDisplayString)(s.highlight)+" ",1),s.link?((0,l.openBlock)(),(0,l.createElementBlock)("div",Oe,[(0,l.createElementVNode)("a",{"aria-label":t.variableDef.name,href:s.link,target:"_blank",rel:"noopener noreferrer nofollow"},[(0,l.createVNode)(n,{k:"capi.cluster.variables.learnMore"}),a[1]||(a[1]=(0,l.createTextVNode)()),a[2]||(a[2]=(0,l.createElementVNode)("i",{class:"icon-external-link icon-sm"},null,-1))],8,$e)])):(0,l.createCommentVNode)("",!0)],512),[[l.vShow,r.open]])])],2)):(0,l.renderSlot)(e.$slots,"highlight",{key:1,toggleOpen:s.toggleOpen},void 0,!0)}var Te={name:"CCvariableDefHighlightWrapper",props:{variableDef:{type:Object,required:!0},variableValue:{type:[Object,String,Number,Array,Boolean],default:null},mode:{type:String,default:s.YQ},willOpen:{type:Boolean,default:!0},isToggle:{type:Boolean,default:!1},isMachineScoped:{type:Boolean,default:!1}},data(){return{open:this.isToggle?!!this.variableValue:this.willOpen}},watch:{willOpen(e){this.open=e},variableValue(e){this.isToggle&&e&&(this.open=e)},highlightColor:{immediate:!0,handler(e){"error"===e&&(this.open=!0)}}},methods:{toggleOpen(e){this.open=e}},computed:{highlightColor(){let e=this.variableDef?.metadata?.annotations?.[p.BC.HIGHLIGHT];return!e&&this.variableDef?.metadata?.annotations?.[p.BC.SEARCH_TYPE]&&(e="info"),e},highlight(){return this.variableDef?.schema?.openAPIV3Schema?.description},link(){return this.variableDef?.metadata?.annotations?.[p.BC.DOCS]},showHighlight(){return!!this.highlightColor&&!this.isMachineScoped},searchType(){return this.variableDef?.metadata?.annotations?.[p.BC.SEARCH_TYPE]||""},displayName(){return this.$store.getters["i18n/withFallback"](`capi.variables.${this.variableDef.name}`,null,this.variableDef.name)},required(){return this.variableDef?.required}}};t(18145);const Re=(0,ue.A)(Te,[["render",De],["__scopeId","data-v-5dd32f20"]]);var _e=Re;const Le=2;var Ue={name:"CCVariable",emits:["validation-passed","update:value","error"],components:{YamlEditor:X.A,VariableHighlight:_e},props:{variable:{type:Object,required:!0},value:{type:[String,Object,Boolean,Array,Number],default:()=>null},isMachineScoped:{type:Boolean,default:!1},allVariables:{type:Array,default:()=>[]},globalVariables:{type:Array,default:()=>[]},willOpen:{type:Boolean,default:!0},allDefinitions:{type:Array,default:()=>[]},clusterNamespace:{type:String,default:""},mode:{type:String,default:s.YQ}},watch:{isValid(e){this.$emit("validation-passed",e)}},created(){this.isValid||this.$emit("validation-passed",!1),(this.isYamlComponent||this.isYamlKeyValueComponent)&&(this.yamlPlaceholder=this.generateYamlPlaceholder())},data(){return{noneOption:this.t("capi.cluster.variables.emptyStringOption"),annotationError:"",yamlPlaceholder:""}},computed:{...(0,M.L8)({t:"i18n/t",withFallback:"i18n/withFallback"}),schema(){return this.variable?.schema?.openAPIV3Schema},variableOptions(){const e=this.schema?.enum;return e&&e.length?e.map((e=>{let a="object"===typeof e?JSON.stringify(e):e;return""===e&&(a=this.noneOption),a})):null},validationRules(){if(this.isDefaultValue)return[];const e=this.t,a=(0,J.qW)(e,{key:this.variable.name},this.schema),t=this.variable?.required;return t&&!this.isMachineScoped&&a.push((a=>(0,J.O9)(a)?void 0:e("validation.required",{key:this.variable.name}))),a},isDefaultValue(){const e=this.schema.default;return void 0!==e&&Z()(e,this.value)},isValid(){return!this.validationErrors.length},validationErrors(){return this.validationRules.reduce(((e,a)=>{const t=a(this.value);return t&&e.push(t),e}),[])},componentForType(){return ye(this.variable,this.allDefinitions)},isListComponent(){return this.componentForType?.name===he.ARRAY||this.componentForType?.name===he.MAP||this.componentForType?.name===he.MAP_YAML},isYamlComponent(){return this.componentForType?.name===he.YAML},isYamlKeyValueComponent(){return this.isListComponent&&this.schema?.additionalProperties?.properties},displayClasses(){const e={wider:this.isListComponent,widest:this.isYamlKeyValueComponent||this.isYamlComponent||this.highlighted||this.isSearchComponent},a=(this.variable?.metadata?.annotations?.[p.BC.TOGGLED_BY]||"").split(",").map((e=>e.replace(" ",""))),t=(this.allVariables||[]).filter((e=>a.includes(e.name)))?.length;return e.depth=t<=Le?`depth-${t}`:"depth-max",e},placeholder(){if(this.isMachineScoped){const e=this.globalVariables.find((e=>e.name===this.variable.name))?.value;if(e)return e}return this.schema.example},toggled(){try{const e=(this.variable?.metadata?.annotations?.[p.BC.TOGGLED_BY]||"").split(",").map((e=>e.replace(" ",""))),a=(this.allVariables||[]).filter((a=>e.includes(a.name)));if(a&&a.length){const e=!!a.find((e=>!e.value));return!e}return!0}catch(e){return this.annotationError=this.t("error.parseVariableAnnotation",{variable:this.withFallback(`capi.variables.${this.label}`,null,this.label),annotation:p.BC.TOGGLED_BY}),!0}},isToggle(){return be(this.variable,this.allDefinitions)},label(){return this.variable?.metadata?.annotations?.[p.BC.LABEL]||this.variable.name},highlighted(){return!!this.variable?.metadata?.annotations?.[p.BC.HIGHLIGHT]&&!this.isMachineScoped},isSearchComponent(){return this.componentForType.name===he.SEARCH_TYPE},resourceType(){return this.variable?.metadata?.annotations?.[p.BC.SEARCH_TYPE]},displayValue(){return this.isYamlComponent?this.yamlPlaceholder||this.value:this.variableOptions?.length&&""===this.value?this.noneOption:this.value},tooltip(){let e="";return!this.highlighted&&this.schema.description&&(e+=this.schema.description),this.annotationError&&(e+=this.annotationError),e}},methods:{setYamlMapValue(e,a,t){try{const l=Q().load(e);a.value=l,t()}catch(l){const e=this.t("error.yamlParseError",{variable:this.variable.name})+l;this.$emit("error",e)}},setValue(e,a){let t=e;if(this.isYamlComponent)try{t=Q().load(e)}catch(l){}this.isToggle&&a(e),this.variableOptions?.length&&e===this.noneOption&&(t=""),this.$emit("update:value",t)},generateYamlPlaceholder(){if(this.isYamlComponent||this.isYamlKeyValueComponent){try{const e=Ce(this.schema);return e||""}catch(e){const a=this.t("error.yamlPlaceholderError",{variable:this.variable.name})+e;this.$emit("error",a)}return""}}}};t(36700);const Me=(0,ue.A)(Ue,[["render",z],["__scopeId","data-v-3a9e34e9"]]);var Fe=Me,Ie=t(21412),qe=t(45505),je={name:"ClusterClassVariables",components:{Variable:Fe,GroupPanel:Ie.A,Accordion:qe.A},emits:["validation-passed","update:value","update-variables","error"],props:{clusterClass:{type:Object,default:()=>{}},value:{type:Array,default:()=>[]},machineClassType:{type:String,default:null},machineClassName:{type:String,default:null},globalVariables:{type:Array,default:()=>[]},section:{type:String,default:""},willOpen:{type:Boolean,default:!0},clusterNamespace:{type:String,default:""},mode:{type:String,default:s.YQ}},data(){return{errorCount:0,rerenderKey:(0,F.vx)(),expanded:!1}},watch:{errorCount(e){this.$emit("validation-passed",!e)},variableDefinitions(e,a){this.isMachineScoped||this.updateVariableDefaults(e,a),this.$nextTick((()=>{this.rerenderKey=(0,F.vx)()}))}},created(){this.isMachineScoped||this.updateVariableDefaults(this.variableDefinitions,[])},computed:{...(0,M.L8)({withFallback:"i18n/withFallback",t:"i18n/t"}),ownedVariables(){return this.value.filter((e=>this.ownedVariableNames.includes(e.name)))},isMachineScoped(){return!!this.machineClassName&&!!this.machineClassType},variableDefinitions(){const e=this.clusterClass?.spec?.variables||[];if(!this.isMachineScoped)return this.section?e.filter((e=>(e?.metadata?.annotations?.[p.BC.SECTION]||"").toLowerCase()===this.section)):e.filter((e=>!Object.values(pt).includes((e?.metadata?.annotations?.[p.BC.SECTION]||"").toLowerCase())||!e?.metadata?.annotations?.[p.BC.SECTION]));const a=this.machineScopedJsonPatches.reduce(((e,a)=>{const t=a?.valueFrom?.variable;if(!t)return e;const l=t.split(/\.|\[/)[0];return"builtin"!==l&&e.push(l),e}),[]);return e.filter((e=>a.includes(e.name)))},sectionedVariableDefinitions(){const e={};return this.variableDefinitions.forEach((a=>{const t=a?.metadata?.annotations?.[p.BC.SECTION]||"misc";e[t]?e[t].push(a):e[t]=[a]})),e},groupedVariableDefinitions(){const e={},a=this.isMachineScoped?{misc:this.variableDefinitions}:this.sectionedVariableDefinitions;for(const t in a){const l={};a[t].forEach((e=>{const a=e?.metadata?.annotations?.[p.BC.GROUP]||"misc";l[a]?l[a].push(e):l[a]=[e]})),e[t]=l}return e},ownedVariableNames(){const e=[];return Object.keys(this.groupedVariableDefinitions||{}).forEach((a=>{Object.keys(this.groupedVariableDefinitions[a]||{}).forEach((t=>{const l=this.groupedVariableDefinitions[a][t]||[];l.length&&e.push(...l.map((e=>e.name)))}))})),e},machineScopedJsonPatches(){if(!this.isMachineScoped)return[];const e=[],a=this.machineClassName,t=this.machineClassType,l=this.clusterClass?.spec?.patches||[];return l.forEach((l=>{const o=l?.definitions||[];o.forEach((l=>{const o=l?.selector?.matchResources?.[t]?.names||[];o.includes(a)&&e.push(...l.jsonPatches)}))})),e}},methods:{valueFor(e){return(this.value.find((a=>a.name===e.name))||{}).value},updateVariables(e,a){const t=[...this.ownedVariables],l=this.ownedVariables.findIndex((e=>e.name===a.name));l>=0?t[l].value=e:t.push({value:e,name:a.name}),this.$emit("update-variables",t,this.ownedVariableNames),this.$emit("update:value",t)},updateVariableDefaults(e,a){const t=[...this.ownedVariables].reduce(((t,l)=>{const o=(e||[]).find((e=>e.name===l.name));if(!o)return t;const r=(a||[]).find((e=>e.name===l.name))?.schema?.openAPIV3Schema?.default;void 0!==r&&l.value===r&&delete l.value;let s=o.schema?.openAPIV3Schema?.default;return"boolean"!==o.schema?.openAPIV3Schema?.type||s||(s=!1),void 0===s||l.value||(l.value=s),t.push(l),t}),[]);e.forEach((e=>{let a=e.schema?.openAPIV3Schema?.default;"boolean"!==e.schema?.openAPIV3Schema?.type||a||(a=!1),void 0===a||t.find((a=>a.name===e.name))||t.push({name:e.name,value:a})})),this.errorCount=0,this.$emit("update-variables",t,this.ownedVariableNames),this.$emit("update:value",t)},updateErrors(e){this.errorCount=e?this.errorCount-1:this.errorCount+1}}};t(42414);const Ge=(0,ue.A)(je,[["render",U],["__scopeId","data-v-c48e8af6"]]);var Ye=Ge;const He={key:0,class:"container"},ze=["data-testid","onClick"],Ke={key:1,class:"m-50 text-center"};function Ze(e,a,t,o,r,s){const n=(0,l.resolveComponent)("ClusterClassCard"),i=(0,l.resolveDirective)("t");return t.rows.length?((0,l.openBlock)(),(0,l.createElementBlock)("div",He,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.rows,((e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:s.get(e,t.keyField),"data-testid":t.componentTestid+"-"+a,onClick:t=>s.select(e,a)},[(0,l.createVNode)(n,{value:e.obj,selected:e.selected},null,8,["value","selected"])],8,ze)))),128))])):((0,l.openBlock)(),(0,l.createElementBlock)("div",Ke,[(0,l.renderSlot)(e.$slots,"no-rows",{},(()=>[(0,l.withDirectives)((0,l.createElementVNode)("h1",null,null,512),[[i,t.noDataKey]])]),!0)]))}var We=t(56005),Qe=t.n(We);const Xe={class:"card-wrap"},Je={class:"name"},ea={class:"description"},aa={class:"container"},ta={class:"leftcol"},la={class:"rightcol"};function oa(e,a,t,o,r,s){const n=(0,l.resolveComponent)("ClusterCardField");return(0,l.openBlock)(),(0,l.createElementBlock)("div",{class:(0,l.normalizeClass)(["cluster-card-container",{selected:!!t.selected}]),"data-testid":"cluster-class-card"},[(0,l.createElementVNode)("div",Xe,[(0,l.createElementVNode)("div",Je,(0,l.toDisplayString)(s.name),1),(0,l.createElementVNode)("div",ea,[(0,l.createElementVNode)("p",null,(0,l.toDisplayString)(s.description),1)]),(0,l.createElementVNode)("div",aa,[(0,l.createElementVNode)("div",ta,[(0,l.createVNode)(n,{value:s.controlPlaneName,name:e.t("capi.clusterClassCard.controlPlaneName")},null,8,["value","name"]),(0,l.createVNode)(n,{value:s.controlPlaneKind,name:e.t("capi.clusterClassCard.controlPlaneKind")},null,8,["value","name"]),(0,l.createVNode)(n,{value:s.controlPlaneNamespace,name:e.t("capi.clusterClassCard.controlPlaneNamespace")},null,8,["value","name"])]),(0,l.createElementVNode)("div",la,[s.machineDeploymentsCount>0?((0,l.openBlock)(),(0,l.createBlock)(n,{key:0,value:s.machineDeploymentsList,name:e.t("capi.clusterClassCard.machineDeploymentsCount",{count:s.machineDeploymentsCount})},null,8,["value","name"])):(0,l.createCommentVNode)("",!0),s.machinePoolsCount>0?((0,l.openBlock)(),(0,l.createBlock)(n,{key:1,value:s.machinePoolsList,name:e.t("capi.clusterClassCard.machinePoolsCount",{count:s.machinePoolsCount})},null,8,["value","name"])):(0,l.createCommentVNode)("",!0)])])])],2)}const ra={class:"label"},sa={class:"text-label"},na={class:"value"};function ia(e,a,t,o,r,s){return(0,l.openBlock)(),(0,l.createElementBlock)("div",ra,[(0,l.createElementVNode)("div",sa,[(0,l.renderSlot)(e.$slots,"name",{},(()=>[(0,l.createTextVNode)((0,l.toDisplayString)(t.name),1)]),!0)]),(0,l.createElementVNode)("div",na,[(0,l.renderSlot)(e.$slots,"value",{},(()=>[(0,l.createTextVNode)((0,l.toDisplayString)(t.value),1)]),!0)])])}var ca={props:{name:{type:String,required:!0},value:{type:[Number,String,void 0],default:""}}};t(13523);const da=(0,ue.A)(ca,[["render",ia],["__scopeId","data-v-7407ec5d"]]);var pa=da,ua={name:"ClusterClassCard",components:{ClusterCardField:pa},props:{value:{type:Object,required:!0},selected:{type:Boolean,default:!1}},data(){return{cloneData:!0,errors:[]}},computed:{...(0,M.L8)({t:"i18n/t"}),name(){return this.value?.metadata?.name||""},description(){return this.value?.metadata?.annotations?.description||""},controlPlaneName(){return this.value?.spec?.controlPlane?.ref?.name},controlPlaneKind(){return this.value?.spec?.controlPlane?.ref?.kind},controlPlaneNamespace(){return this.value?.spec?.controlPlane?.ref?.namespace},machineDeploymentsCount(){return this.value?.spec?.workers?.machineDeployments?.length},machineDeploymentsList(){return this.value?.spec?.workers?.machineDeployments?.map((e=>e.class)).join(", ")||""},machinePoolsCount(){return this.value?.spec?.workers?.machinePools?.length},machinePoolsList(){return this.value?.spec?.workers?.machinePools?.map((e=>e.class)).join(", ")||""}}};t(47985);const ma=(0,ue.A)(ua,[["render",oa],["__scopeId","data-v-2904248b"]]);var va=ma,ha={components:{ClusterClassCard:va},name:"CardGrid",emits:["clicked"],props:{rows:{type:Array,required:!0},keyField:{type:String,default:"key"},noDataKey:{type:String,default:"sortableTable.noRows"},componentTestid:{type:String,default:"select-card-grid"}},methods:{get:n.Jt,select(e,a){this.resetSelected(),this.rows[a].selected=!0,this.$emit("clicked",e,a)},resetSelected(){this.rows.map((e=>{e.selected=!1}))},capitalize:Qe()}};t(73878);const ga=(0,ue.A)(ha,[["render",Ze],["__scopeId","data-v-45950a2e"]]);var ba=ga;const fa={class:"span-12"},ya={key:0,class:"clearfix"},ka={key:0,class:"footer mt-20"},Ca=["disabled"],wa={key:0,class:"mr-5 icon icon-spinner icon-spin icon-lg"},Va=["data-testid"],Na={class:"value row row-wi"},Ea={class:"col-long span-5"},xa={key:0,class:"col-long span-5"},Ba={class:"col-short mr-10 span-2"},Sa={class:"remove"},Pa=["disabled","data-testid","onClick"],Aa={key:0,class:"machine-variables"},Oa={key:2,class:"text-muted"},$a={key:3};function Da(e,a,t,o,r,s){const n=(0,l.resolveComponent)("LabeledSelect"),i=(0,l.resolveComponent)("LabeledInput"),c=(0,l.resolveComponent)("CCVariables");return(0,l.openBlock)(),(0,l.createElementBlock)("div",fa,[s.title?((0,l.openBlock)(),(0,l.createElementBlock)("div",ya,[s.isView?(0,l.createCommentVNode)("",!0):((0,l.openBlock)(),(0,l.createElementBlock)("div",ka,[(0,l.createElementVNode)("button",{type:"button",class:"btn role-tertiary add",disabled:t.loading,"data-testid":"array-list-button",onClick:a[0]||(a[0]=e=>s.add())},[t.loading?((0,l.openBlock)(),(0,l.createElementBlock)("i",wa)):(0,l.createCommentVNode)("",!0),(0,l.createTextVNode)(" "+(0,l.toDisplayString)(s.addLabel),1)],8,Ca)]))])):(0,l.createCommentVNode)("",!0),r.rows.length?((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:1},(0,l.renderList)(r.rows,((a,o)=>((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:o,"data-testid":`${t.componentTestid}-box${o}`,class:"box"},[(0,l.createElementVNode)("div",Na,[(0,l.createElementVNode)("div",Ea,[(0,l.createVNode)(n,{value:a.value.class,"onUpdate:value":e=>a.value.class=e,mode:t.mode,options:t.classOptions,"label-key":"capi.cluster.workers.class",required:""},null,8,["value","onUpdate:value","mode","options"])]),a.value.class?((0,l.openBlock)(),(0,l.createElementBlock)("div",xa,[(0,l.createVNode)(i,{ref_for:!0,ref:"value",value:a.value.name,"onUpdate:value":e=>a.value.name=e,mode:t.mode,disabled:!1,label:e.t("capi.cluster.workers.name"),required:""},null,8,["value","onUpdate:value","mode","label"])])):(0,l.createCommentVNode)("",!0),(0,l.createElementVNode)("div",Ba,[(0,l.createVNode)(i,{value:a.value.replicas,mode:t.mode,disabled:!1,label:e.t("capi.cluster.workers.replicas"),type:"number",placeholder:"1","onUpdate:value":e=>a.value.replicas=e?parseInt(e):null},null,8,["value","mode","label","onUpdate:value"])]),(0,l.withDirectives)((0,l.createElementVNode)("div",Sa,[(0,l.createElementVNode)("button",{type:"button",disabled:s.isView,class:"btn role-link","data-testid":`${t.componentTestid}-remove-item-${o}`,onClick:e=>s.remove(a,o)},(0,l.toDisplayString)(s.removeLabel),9,Pa)],512),[[l.vShow,r.rows.length>1]])]),a.value.class?((0,l.openBlock)(),(0,l.createElementBlock)("div",Aa,[(0,l.createVNode)(c,{value:a.value.variables.overrides,"onUpdate:value":e=>a.value.variables.overrides=e,"global-variables":t.globalVariables,"cluster-class":t.clusterClass,mode:t.mode,"machine-class-name":a.value.class,"machine-class-type":s.machineClassType},null,8,["value","onUpdate:value","global-variables","cluster-class","mode","machine-class-name","machine-class-type"])])):(0,l.createCommentVNode)("",!0)],8,Va)))),128)):"view"===t.mode?((0,l.openBlock)(),(0,l.createElementBlock)("div",Oa," — ")):((0,l.openBlock)(),(0,l.createElementBlock)("div",$a))])}var Ta=t(12784),Ra=t.n(Ta),_a={components:{LabeledSelect:O.A,LabeledInput:S.A,CCVariables:Ye},emits:["add","remove","update:value"],props:{value:{type:Array,default:null},mode:{type:String,default:s.G5},isDeployments:{type:Boolean,default:!0},classOptions:{type:Array,default:null},addBtnTitle:{type:String,default:"Add"},addAllowed:{type:Boolean,default:!0},defaultAddValue:{type:Object,default:""},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},componentTestid:{type:String,default:"worker-item"},globalVariables:{type:Array,default:()=>[]},clusterClass:{type:Object,default:()=>({})}},data(){const e=(this.value||[])?.slice(),a=[];for(const t of e)a.push({value:t});if(!a.length){const e=this.defaultAddValue?(0,n.o8)(this.defaultAddValue):"";a.push({value:e})}return{rows:a,lastUpdateWasFromValue:!1}},computed:{isView(){return this.mode===s.nW},removeLabel(){return this.$store.getters["i18n/t"]("generic.remove")},addLabel(){return this.isDeployments?this.t("capi.cluster.workers.machineDeployments.add"):this.t("capi.cluster.workers.machinePools.add")},machineClassType(){return this.isDeployments?"machineDeploymentClass":"machinePoolClass"},title(){return this.isDeployments?this.t("capi.cluster.workers.machineDeployments.title"):this.t("capi.cluster.workers.machinePools.title")}},watch:{value:{deep:!0,handler(){this.lastUpdateWasFromValue=!0,this.rows=(this.value||[]).map((e=>({value:e})))}},rows:{deep:!0,handler(){this.lastUpdateWasFromValue||this.queueUpdate(),this.lastUpdateWasFromValue=!1}}},created(){this.queueUpdate=Ra()(this.update,50)},methods:{add(){return this.rows.push({value:(0,n.o8)(this.defaultAddValue)}),this.defaultAddValue&&this.queueUpdate(),this.$nextTick((()=>{this.$emit("add")}))},remove(e,a){this.$emit("remove",{row:e,index:a}),(0,B.Wq)(this.rows,a),this.queueUpdate()},update(){if(this.isView)return;const e=[];for(const a of this.rows){const t=a.value;"undefined"!==typeof t&&e.push(t)}this.$emit("update:value",e)},valUpdate(e,a){a.value.name=e.data}}};t(11094);const La=(0,ue.A)(_a,[["render",Da],["__scopeId","data-v-03d3bb46"]]);var Ua=La;const Ma={class:"row row-networking"},Fa={class:"col col-host span-6 mb-20"},Ia={class:"col col-port span-6 mb-20"},qa={class:"row row-networking"},ja={class:"col col-networking mb-20"},Ga={class:"row row-networking"},Ya={class:"col col-networking mb-20"};function Ha(e,a,t,o,r,s){const n=(0,l.resolveComponent)("LabeledInput"),i=(0,l.resolveComponent)("ArrayList");return(0,l.openBlock)(),(0,l.createElementBlock)("div",null,[(0,l.createElementVNode)("div",Ma,[(0,l.createElementVNode)("div",Fa,[(0,l.createVNode)(n,{value:r.serviceDomain,"onUpdate:value":[a[0]||(a[0]=e=>r.serviceDomain=e),s.updateNetwork],mode:t.mode,disabled:s.clusterIsAlreadyCreated,label:e.t("capi.cluster.networking.serviceDomain"),rules:t.rules.serviceDomain},null,8,["value","mode","disabled","label","rules","onUpdate:value"])]),(0,l.createElementVNode)("div",Ia,[(0,l.createVNode)(n,{value:r.apiServerPort,"onUpdate:value":[a[1]||(a[1]=e=>r.apiServerPort=e),s.updateNetwork],type:"number",mode:t.mode,disabled:s.clusterIsAlreadyCreated,label:e.t("capi.cluster.networking.apiServerPort"),rules:t.rules.apiServerPort,placeholder:"6443"},null,8,["value","mode","disabled","label","rules","onUpdate:value"])])]),(0,l.createElementVNode)("div",qa,[(0,l.createElementVNode)("div",ja,[(0,l.createVNode)(i,{value:r.podsCidrBlocks,"onUpdate:value":[a[2]||(a[2]=e=>r.podsCidrBlocks=e),s.updateNetwork],protip:!1,mode:t.mode,title:e.t("capi.cluster.networking.pods.title"),"value-placeholder":e.t("capi.cluster.networking.cidrplaceholder"),rules:t.rules.pods,"add-label":e.t("capi.cluster.networking.pods.add"),"component-testid":"pods-cidr"},null,8,["value","mode","title","value-placeholder","rules","add-label","onUpdate:value"])])]),(0,l.createElementVNode)("div",Ga,[(0,l.createElementVNode)("div",Ya,[(0,l.createVNode)(i,{value:r.servicesCidrBlocks,"onUpdate:value":[a[3]||(a[3]=e=>r.servicesCidrBlocks=e),s.updateNetwork],protip:!1,mode:t.mode,title:e.t("capi.cluster.networking.services.title"),"value-placeholder":e.t("capi.cluster.networking.cidrplaceholder"),rules:t.rules.services,"add-label":e.t("capi.cluster.networking.services.add"),"component-testid":"services-cidr"},null,8,["value","mode","title","value-placeholder","rules","add-label","onUpdate:value"])])])])}var za={name:"NetworkSelection",emits:["update:value"],components:{LabeledInput:S.A,ArrayList:le.A},props:{value:{type:Object,required:!0},mode:{type:String,required:!0},rules:{default:()=>({serviceDomain:[],apiServerPort:[],pods:[],services:[]}),type:Object}},data(){return{serviceDomain:this?.value?.clusterNetwork?.serviceDomain||"",apiServerPort:this?.value?.clusterNetwork?.apiServerPort||"",podsCidrBlocks:this?.value?.clusterNetwork?.pods?.cidrBlocks||[],servicesCidrBlocks:this?.value?.clusterNetwork?.services?.cidrBlocks||[]}},computed:{...(0,M.L8)({t:"i18n/t"}),clusterIsAlreadyCreated(){return this.mode===s.G5}},methods:{updateNetwork(){if(this.serviceDomain||this.apiServerPort||0!==this.podsCidrBlocks.length||0!==this.servicesCidrBlocks.length){const e={};this.serviceDomain&&(e.serviceDomain=this.serviceDomain),this.apiServerPort&&(e.apiServerPort=parseInt(this.apiServerPort)),this.podsCidrBlocks.length>0&&(e.pods={cidrBlocks:this.podsCidrBlocks}),this.servicesCidrBlocks.length>0&&(e.services={cidrBlocks:this.servicesCidrBlocks}),this.$emit("update:value",e)}else this.$emit("update:value",null)}}};t(67496);const Ka=(0,ue.A)(za,[["render",Ha],["__scopeId","data-v-89f357b2"]]);var Za=Ka;const Wa={class:"row row-cp"},Qa={class:"col col-host span-6 mb-20"},Xa={class:"col col-port span-6 mb-20"};function Ja(e,a,t,o,r,s){const n=(0,l.resolveComponent)("LabeledInput");return(0,l.openBlock)(),(0,l.createElementBlock)("div",null,[(0,l.createElementVNode)("div",Wa,[(0,l.createElementVNode)("div",Qa,[(0,l.createVNode)(n,{value:r.host,"onUpdate:value":[a[0]||(a[0]=e=>r.host=e),s.updateControlPlaneEndpoint],mode:t.mode,disabled:s.clusterIsAlreadyCreated,label:e.t("capi.cluster.controlPlaneEndpoint.host"),rules:t.rules.host},null,8,["value","mode","disabled","label","rules","onUpdate:value"])]),(0,l.createElementVNode)("div",Xa,[(0,l.createVNode)(n,{value:r.port,"onUpdate:value":[a[1]||(a[1]=e=>r.port=e),s.updateControlPlaneEndpoint],mode:t.mode,disabled:s.clusterIsAlreadyCreated,label:e.t("capi.cluster.controlPlaneEndpoint.port"),rules:t.rules.port,type:"number",placeholder:"49152"},null,8,["value","mode","disabled","label","rules","onUpdate:value"])])])])}var et={name:"ControlPlaneEndpointSection",components:{LabeledInput:S.A},emits:["update:value"],props:{value:{type:Object,required:!0},mode:{type:String,required:!0},rules:{default:()=>({host:[],port:[]}),type:Object}},data(){return{host:this?.value?.host||"",port:this?.value?.port||""}},computed:{...(0,M.L8)({t:"i18n/t"}),clusterIsAlreadyCreated(){return this.mode===s.G5}},methods:{updateControlPlaneEndpoint(){if(this.host||this.port){const e={};this.host&&(e.host=this.host),this.port&&(e.port=parseInt(this.port)),this.$emit("update:value",e)}else this.$emit("update:value",null)}}};t(98695);const at=(0,ue.A)(et,[["render",Ja],["__scopeId","data-v-aeee92ae"]]);var tt=at;const lt={class:"row row-cp mb-20"};function ot(e,a,t,o,r,s){const n=(0,l.resolveComponent)("LabeledInput");return(0,l.openBlock)(),(0,l.createElementBlock)("div",lt,[(0,l.createVNode)(n,{value:s.replicas,mode:t.mode,disabled:s.clusterIsAlreadyCreated,label:e.t("capi.cluster.topology.controlPlane.replicas"),rules:t.rules.replicas,type:"number",placeholder:"1","onUpdate:value":a[0]||(a[0]=a=>e.$emit("update:value",a))},null,8,["value","mode","disabled","label","rules"])])}var rt={name:"NetworkSelection",components:{LabeledInput:S.A},emits:["update:value"],props:{value:{type:Object,required:!0},mode:{type:String,required:!0},rules:{default:()=>({replicas:[]}),type:Object}},computed:{...(0,M.L8)({t:"i18n/t"}),clusterIsAlreadyCreated(){return this.mode===s.G5},replicas(){return this.value?.replicas||""}}};t(67066);const st=(0,ue.A)(rt,[["render",ot],["__scopeId","data-v-32521d48"]]);var nt=st,it=t(82451),ct=t.n(it);const dt={version:"",class:"",workers:{machineDeployments:[],machinePools:[]}},pt={GENERAL:"general",CONTROL_PLANE:"controlplane",NETWORKING:"networking",WORKERS:"workers",LABELS:"labels"};var ut={name:"ClusterConfig",components:{CruResource:d.A,NameNsDescription:P.A,LabeledInput:S.A,WorkerItem:Ua,NetworkSection:Za,ControlPlaneEndpointSection:tt,ClusterClassVariables:Ye,CardGrid:ba,Labels:$.A,ControlPlaneSection:nt,Checkbox:ae.A,Loading:c.A,LabeledSelect:O.A,Accordion:qe.A},mixins:[i.A,A.A],emits:["update:value"],props:{mode:{type:String,required:!0},value:{type:Object,required:!0},preselectedClass:{type:String,required:!1,default:""},clusterClasses:{type:Array,required:!0}},beforeMount(){this.initSpecs().then((()=>{})).catch((e=>{this.errors.push(e),this.loading=!1})),this.$store.dispatch("management/request",{url:"/v1-k3s-release/releases"}).then((e=>{this.k3sVersions=e})),this.$store.dispatch("management/request",{url:"/v1-rke2-release/releases"}).then((e=>{this.rke2Versions=e})),this.$nextTick((()=>{this.loading=!1}))},data(){const e=this.$store,a=e.getters["i18n/t"],t={name:"stepClusterClass",title:a("capi.cluster.steps.clusterClass.title"),label:a("capi.cluster.steps.clusterClass.label"),subtext:"",descriptionKey:"capi.cluster.steps.clusterClass.description",ready:!1,weight:30},l={name:"stepConfiguration",title:a("capi.cluster.steps.configuration.title"),label:a("capi.cluster.steps.configuration.label"),subtext:"",descriptionKey:"capi.cluster.steps.configuration.description",ready:!1,weight:30},o=this.preselectedClass?[l]:[t,l];return{addSteps:o,fvFormRuleSets:[{path:"metadata.name",rules:["required"]},{path:"spec.topology.version",rules:["required","version"]},{path:"spec.topology.controlPlane.replicas",rules:["number"]},{path:"spec.controlPlaneEndpoint.host",rules:["host"]},{path:"spec.controlPlaneEndpoint.port",rules:["port"]},{path:"spec.clusterNetwork.serviceDomain",rules:["host"]},{path:"spec.clusterNetwork.apiServerPort",rules:["port"]},{path:"spec.clusterNetwork.pods.cidrBlocks",rules:["cidr"]},{path:"spec.clusterNetwork.services.cidrBlocks",rules:["cidr"]}],credentialId:"",credential:null,versionInfo:{},variableSectionReady:{general:!0,controlPlane:!0,networking:!0,misc:!0,workers:!0},clusterClassObj:null,loading:!0,k3sVersions:[],rke2Versions:[],autoImport:!!this.value?.metadata?.labels&&!!this.value?.metadata?.labels[p.kg.AUTO_IMPORT],classNamespaceSupported:!1,allNamespaces:[],configHighlightOpen:!0,controlPlaneHighlightOpen:!0,networkingHighlightOpen:!0}},watch:{clusterClassObj(e){const a=this.addSteps.find((e=>"stepClusterClass"===e.name));a&&(a.ready=!!e)},stepConfigurationRequires(e){const a=this.addSteps.find((e=>"stepConfiguration"===e.name));a.ready=!!e}},computed:{...(0,M.L8)({t:"i18n/t",schemaFor:"management/schemaFor"}),fvExtraRules(){return{version:(0,J.tn)(this.t,this.clusterClassControlPlane),host:(0,J.l1)(this.t),port:(0,J.Q3)(this.t),cidr:(0,J.z0)(this.t)}},formSections(){return pt},machineDeploymentsValid(){if(this.value?.spec?.topology?.workers?.machineDeployments&&this.value?.spec?.topology?.workers?.machineDeployments.length>0)for(const e of this.value?.spec?.topology?.workers?.machineDeployments)if(!e.name||!e.class||Number.isNaN(e.replicas))return!1;return!0},machinePoolsValid(){if(this.value?.spec?.topology?.workers?.machinePools&&this.value?.spec?.topology?.workers?.machinePools.length>0)for(const e of this.value?.spec?.topology?.workers?.machinePools)if(!e.name||!e.class||Number.isNaN(e.replicas))return!1;return!0},variablesValid(){return!Object.values(this.variableSectionReady).includes(!1)},stepConfigurationRequires(){const e=(this.value?.spec?.topology?.workers?.machinePools&&this.value?.spec?.topology?.workers?.machinePools.length>0||this.value?.spec?.topology?.workers?.machineDeployments&&this.value?.spec?.topology?.workers?.machineDeployments.length>0)&&this.machineDeploymentsValid&&this.machinePoolsValid;return this.fvFormIsValid&&e&&this.variablesValid},clusterIsAlreadyCreated(){return this.mode===s.G5},controlPlane:{get(){return this.value?.spec?.topology?.controlPlane||{}},set(e){e?this.value.spec.topology.controlPlane={replicas:parseInt(e)}:delete this.value.spec.topology.controlPlane}},controlPlaneEndpoint:{get(){return this.value?.spec?.controlPlaneEndpoint||{}},set(e){e?this.value.spec.controlPlaneEndpoint=e:delete this.value.spec.controlPlaneEndpoint}},network:{get(){return this.value?.spec?.clusterNetwork||{}},set(e){e?this.value.spec.clusterNetwork=e:delete this.value.spec.clusterNetwork}},topology(){return this.value?.spec?.topology},machineDeployments:{get(){return this.value?.spec?.topology?.workers?.machineDeployments||[]},set(e){this.value?.spec?.topology?.workers?.machineDeployments||(this.value.spec.topology=ct()(dt,this.value.spec.topology)),this.value.spec.topology.workers.machineDeployments=e}},machinePools:{get(){return this.value?.spec?.topology?.workers?.machinePools||[]},set(e){this.value?.spec?.topology?.workers?.machinePools||(this.value.spec.topology=ct()(dt,this.value.spec.topology)),this.value.spec.topology.workers.machinePools=e}},variables:{get(){return this?.value?.spec?.topology?.variables||[]},set(e){this.value.spec.topology||(this.value.spec.topology={}),this.value.spec.topology.variables=e}},machineDeploymentOptions(){return this.clusterClassObj?.spec?.workers?.machineDeployments?.map((e=>e.class))},machinePoolOptions(){return this.clusterClassObj?.spec?.workers?.machinePools?.map((e=>e.class))},clusterClassControlPlane(){return this.clusterClassObj?.spec?.controlPlane?.ref?.kind},clusterClassOptions(){const e=[],a=this.clusterClassObj;return this.clusterClasses.forEach((e=>{t(e)})),e;function t(t){const l=t?.id,o={id:l,obj:t,selected:a===t};e.push(o)}},canCreateGitRepos(){const e=this.$store.getters["management/schemaFor"](ce.Hs.GIT_REPO);return e&&e?.collectionMethods.find((e=>"post"===e.toLowerCase()))},isk3s(){return this.clusterClassControlPlane===p.qt.K3S_CP},isRke2(){return this.clusterClassControlPlane===p.qt.RKE2_CP},versionOptions(){return this.isk3s?(this.k3sVersions?.data||[]).map((e=>e.version)).reverse():this.isRke2?(this.rke2Versions?.data||[]).map((e=>e.version)).reverse():[]},defaultDeploymentAddValue(){let e="";return this.machineDeploymentOptions&&1===this.machineDeploymentOptions.length&&(e=this.machineDeploymentOptions[0]),{name:"",class:e,variables:{overrides:[]}}},defaultPoolAddValue(){let e="";return this.machinePoolOptions&&1===this.machinePoolOptions.length&&(e=this.machinePoolOptions[0]),{name:"",class:e,variables:{overrides:[]}}}},methods:{set:n.hZ,setClassInfo(e){this.clusterClassObj=this.clusterClasses.find((a=>{const t=unescape(e).split("/");return a.metadata.namespace===t[0]&&a.metadata.name===t[1]}))||null,this.clusterClassObj?(this.setClass(),this.setClassNamespace()):this.errors.push(this.t("error.clusterClassNotFound"))},async setClass(){this.topology.class&&await this.initSpecs(!0);const e=this.clusterClassObj?.metadata?.name;this.$emit("update:value",{k:"spec.topology.class",val:e})},setClassNamespace(){const e=this.clusterClassObj?.metadata?.namespace;this.$emit("update:value",{k:"metadata.namespace",val:e}),this.classNamespaceSupported&&(this.value.spec.topology.classNamespace=e)},setVariables(e,a){const t=(this.value?.spec?.topology?.variables||[]).filter((e=>!a.includes(e.name)));this.value.spec.topology.variables=t,this.value.spec.topology.variables.push(...e)},async saveOverride(){this.errors&&(0,B.IU)(this.errors);try{return await this.value.save(),this.done()}catch(e){this.errors.push(e)}},async initSpecs(e=!1){const a=this.$store.getters["currentStore"](ce.CU),t=this.value;let l=[];if(t&&!e||((0,n.hZ)(t,"spec",{}),(0,n.hZ)(t,"metadata",{labels:{},annotations:{}})),t.spec.topology&&!e||(0,n.hZ)(t.spec,"topology",(0,n.o8)(dt)),this.$emit("update:value",{k:"spec",val:t.spec}),!e){this.preselectedClass&&this.setClassInfo(this.preselectedClass);const e=this.$store.getters["management/schemaFor"](p.qt.CLUSTER);await e.fetchResourceFields(),e.schemaDefinitions?.[`${e.schemaDefinition.type}.spec.topology`]?.resourceFields?.classNamespace&&(this.classNamespaceSupported=!0,l=await this.$store.dispatch(`${a}/findAll`,{type:ce.CU})),this.allNamespaces=l||[]}},cancelCredential(){this.$refs.cruresource&&this.$refs.cruresource.emitOrRoute()},cancel(){this.$router.push({name:"c-cluster-manager-capi",params:{}})},done(){this.$router.push({name:"c-cluster-manager-capi",params:{}})},clickedType(e){this.clusterClassObj=this.clusterClasses.find((a=>a.id===e.id))||null,this.setClass(),this.setClassNamespace()},enableAutoImport(e){e?this.value.metadata.labels["cluster-api.cattle.io/rancher-auto-import"]="true":delete this.value.metadata.labels["cluster-api.cattle.io/rancher-auto-import"]},openRepoModal(){this.$store.dispatch("management/promptModal",{component:"AddExampleRepoDialog",modalWidth:"800px"})}}};t(39846);const mt=(0,ue.A)(ut,[["render",x],["__scopeId","data-v-66729100"]]);var vt=mt,ht={name:"CreateCluster",components:{CruResource:d.A,Loading:c.A,ClusterConfig:vt},emits:["update:value"],mixins:[i.A],props:{value:{type:Object,default:null},componentTestid:{type:String,default:"capi-provider-create"},mode:{type:String,required:!0}},beforeMount(){this.value.spec||(0,n.hZ)(this.value,"spec",{}),this.value.id||this.value.metadata||(0,n.hZ)(this.value,"metadata",{}),this.getClusterClasses().then((e=>{this.clusterClasses=e,this.loading=!1})).catch((e=>{this.errors.push(e),this.loading=!1}))},data(){const e=this.$route,a=e.query[s.UA]||null,t=e.query[p.uB.CLASS],l=this.value?.spec?.topology?.class,o=this.value?.metadata?.namespace,r=o&&l?escape(`${o}/${l}`):null,n=t||r||null;return{subType:a,preselectedClass:n,capiProviders:[],clusterClasses:[],loading:!0}},methods:{set:n.hZ,async getClusterClasses(){const e=await this.$store.dispatch("management/findAll",{type:p.qt.CLUSTER_CLASS});return e},cancel(){this.$router.push({name:"c-cluster-manager-capi",params:{}})}}};const gt=(0,ue.A)(ht,[["render",r]]);var bt=gt},8912:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return ne}});var l=t(9274);function o(e,a,t,o,r,s){const n=(0,l.resolveComponent)("SelectIconGrid"),i=(0,l.resolveComponent)("ProviderConfig"),c=(0,l.resolveComponent)("CruResource");return(0,l.openBlock)(),(0,l.createBlock)(c,{mode:e.mode,"validation-passed":!0,"selected-subtype":r.subType,resource:t.value,errors:e.errors,subtypes:s.subTypes,"cancel-event":!0,"prevent-enter-submit":!0,class:"create-cluster",onFinish:e.save,onCancel:e.done,onSelectType:s.selectType,onError:a[1]||(a[1]=a=>e.errors=a)},(0,l.createSlots)({subtypes:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(s.groupedSubTypes,((e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:a,class:(0,l.normalizeClass)({"mt-5":0===a,"mt-20":0!==a}),style:{width:"100%"}},[(0,l.createElementVNode)("h4",null,(0,l.toDisplayString)(e.label),1),(0,l.createVNode)(n,{rows:e.items,"key-field":"id","name-field":"label","side-label-field":"tag",onClicked:s.clickedType},null,8,["rows","onClicked"])],2)))),128))])),default:(0,l.withCtx)((()=>[r.subType?((0,l.openBlock)(),(0,l.createBlock)(i,{key:0,value:t.value,"initial-value":e.initialValue,"live-value":e.liveValue,mode:e.mode,provider:r.subType,category:e.category,"onUpdate:value":a[0]||(a[0]=e=>s.set(t.value,e.k,e.val))},null,8,["value","initial-value","live-value","mode","provider","category"])):(0,l.createCommentVNode)("",!0)])),_:2},[r.subType?{name:"form-footer",fn:(0,l.withCtx)((()=>[a[2]||(a[2]=(0,l.createElementVNode)("div",null,null,-1))])),key:"0"}:void 0]),1032,["mode","selected-subtype","resource","errors","subtypes","onFinish","onCancel","onSelectType"])}var r=t(2517),s=t(17646),n=t(95347),i=t(14220);const c="category";var d=t(24850);const p={key:0},u={class:"row mb-20"},m={class:"col span-3"},v={class:"col span-3"},h={class:"col span-3"},g={class:"row mb-40"},b={class:"col span-6"},f={key:1},y={key:2,class:"mb-10"},k={key:3,class:"mb-20"},C={class:"mb-20"},w={key:1,class:"mb-40"},V={class:"mb-20"},N={key:2},E={key:4,class:"credential-container"},x={class:"mt-20"},B={key:0,class:"row mt-10"};function S(e,a,t,o,r,s){const n=(0,l.resolveComponent)("Loading"),i=(0,l.resolveComponent)("NameNsDescription"),c=(0,l.resolveComponent)("LabeledInput"),d=(0,l.resolveComponent)("LabeledSelect"),S=(0,l.resolveComponent)("t"),P=(0,l.resolveComponent)("Banner"),A=(0,l.resolveComponent)("Checkbox"),O=(0,l.resolveComponent)("KeyValue"),$=(0,l.resolveComponent)("ToggleSwitch"),D=(0,l.resolveComponent)("SelectCredential"),T=(0,l.resolveComponent)("CruResource");return r.loading?((0,l.openBlock)(),(0,l.createBlock)(n,{key:0})):((0,l.openBlock)(),(0,l.createBlock)(T,{key:1,ref:"providercruresource","can-yaml":!1,mode:t.mode,"validation-passed":e.fvFormIsValid,resource:t.value,errors:e.fvUnreportedValidationErrors,"cancel-event":!0,"done-route":e.doneRoute,"apply-hooks":e.applyHooks,class:"provider","component-testid":"capi-provider-create",onDone:e.done,onFinish:s.saveOverride,onCancel:e.done,onError:a[14]||(a[14]=a=>e.errors=a)},(0,l.createSlots)({default:(0,l.withCtx)((()=>[s.isCustom?((0,l.openBlock)(),(0,l.createElementBlock)("div",p,[(0,l.createVNode)(i,{value:t.value,mode:t.mode,namespaced:!0,"namespace-options":r.allNamespaces,"namespace-new-allowed":!0,"create-namespace-override":!0,"name-required":!1,"name-label":"capi.provider.name.label","name-placeholder":"capi.provider.name.placeholder","description-label":"capi.provider.description.label","description-placeholder":"capi.provider.description.placeholder",rules:{name:e.fvGetAndReportPathRules("metadata.name")},"onUpdate:value":a[0]||(a[0]=a=>e.$emit("update:value",{k:"metadata",val:a.metadata}))},null,8,["value","mode","namespace-options","rules"]),(0,l.createElementVNode)("div",u,[(0,l.createElementVNode)("div",m,[(0,l.createVNode)(c,{value:t.value.spec.name,mode:t.mode,"label-key":"capi.provider.label","placeholder-key":"capi.provider.placeholder",required:"",rules:e.fvGetAndReportPathRules("spec.name"),"onUpdate:value":a[1]||(a[1]=a=>e.$emit("update:value",{k:"spec.name",val:a}))},null,8,["value","mode","rules"])]),(0,l.createElementVNode)("div",v,[(0,l.createVNode)(d,{value:t.value.spec.type,mode:t.mode,options:s.typeOptions,"label-key":"capi.provider.type.label",disabled:s.isEdit,required:"","onUpdate:value":a[2]||(a[2]=a=>e.$emit("update:value",{k:"spec.type",val:a}))},null,8,["value","mode","options","disabled"])]),(0,l.createElementVNode)("div",h,[(0,l.createVNode)(c,{value:t.value.spec.version,mode:t.mode,"label-key":"capi.provider.version.label","placeholder-key":"capi.provider.version.placeholder",tooltip:e.t("capi.provider.version.tooltip"),rules:e.fvGetAndReportPathRules("spec.version"),"onUpdate:value":a[3]||(a[3]=a=>e.$emit("update:value",{k:"spec.version",val:a}))},null,8,["value","mode","tooltip","rules"])])]),(0,l.createElementVNode)("div",g,[(0,l.createElementVNode)("div",b,[(0,l.createVNode)(c,{value:t.value.spec.fetchConfig.url,mode:t.mode,"label-key":"capi.provider.fetchConfigURL.label","placeholder-key":"capi.provider.fetchConfigURL.placeholder",rules:e.fvGetAndReportPathRules("spec.fetchConfig.url"),"onUpdate:value":a[4]||(a[4]=a=>e.$emit("update:value",{k:"spec.fetchConfig.url",val:a}))},null,8,["value","mode","rules"])])])])):((0,l.openBlock)(),(0,l.createElementBlock)("div",f,[(0,l.createVNode)(i,{value:t.value,mode:t.mode,namespaced:!0,"namespace-options":r.allNamespaces,"namespace-new-allowed":!0,"create-namespace-override":!0,"name-hidden":!0,"name-label":"capi.provider.name.label","name-placeholder":"capi.provider.name.placeholder","description-label":"capi.provider.description.label","description-placeholder":"capi.provider.description.placeholder","onUpdate:value":a[5]||(a[5]=a=>e.$emit("update:value",{k:"metadata",val:a.metadata}))},null,8,["value","mode","namespace-options"])])),r.credentialComponent?((0,l.openBlock)(),(0,l.createElementBlock)("div",y)):(0,l.createCommentVNode)("",!0),s.hasFeatures||s.hasVariables?((0,l.openBlock)(),(0,l.createElementBlock)("h2",k,[(0,l.createVNode)(S,{k:"capi.provider.secret.title"})])):(0,l.createCommentVNode)("",!0),(0,l.createElementVNode)("div",C,[s.shouldShowBanner?((0,l.openBlock)(),(0,l.createBlock)(P,{key:0,color:"info"},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.t("capi.provider.banner")),1)])),_:1})):(0,l.createCommentVNode)("",!0),s.hasFeatures?((0,l.openBlock)(),(0,l.createElementBlock)("div",w,[(0,l.createElementVNode)("h3",V,[(0,l.createVNode)(S,{k:"capi.provider.features.title"})]),(0,l.createVNode)(A,{value:t.value.spec.features.clusterResourceSet,mode:t.mode,label:e.t("capi.provider.features.clusterResourceSet"),"onUpdate:value":a[6]||(a[6]=a=>e.$emit("update:value",{k:"spec.features.clusterResourceSet",val:a}))},null,8,["value","mode","label"]),(0,l.createVNode)(A,{value:t.value.spec.features.clusterTopology,"onUpdate:value":[a[7]||(a[7]=e=>t.value.spec.features.clusterTopology=e),a[8]||(a[8]=a=>e.$emit("update:value",{k:"spec.features.clusterTopology",val:a}))],mode:t.mode,label:e.t("capi.provider.features.clusterTopology")},null,8,["value","mode","label"]),(0,l.createVNode)(A,{value:t.value.spec.features.machinePool,"onUpdate:value":[a[9]||(a[9]=e=>t.value.spec.features.machinePool=e),a[10]||(a[10]=a=>e.$emit("update:value",{k:"spec.features.machinePool",val:a}))],mode:t.mode,label:e.t("capi.provider.features.machinePool")},null,8,["value","mode","label"])])):(0,l.createCommentVNode)("",!0),s.hasVariables?((0,l.openBlock)(),(0,l.createElementBlock)("div",N,[(0,l.createElementVNode)("h3",null,[(0,l.createVNode)(S,{k:"capi.provider.variables.title"})]),(0,l.createVNode)(O,{value:t.value.spec.variables,"add-label":e.t("capi.provider.variables.add"),mode:t.mode,"value-can-be-empty":!0,"handle-base64":!1,"value-trim":!1,"add-allowed":!0,"read-allowed":!0,"parse-lines-from-file":!0,"onUpdate:value":a[11]||(a[11]=a=>e.$emit("update:value",{k:"spec.variables",val:a}))},null,8,["value","add-label","mode"])])):(0,l.createCommentVNode)("",!0)]),r.credentialComponent?((0,l.openBlock)(),(0,l.createElementBlock)("div",E,[(0,l.createElementVNode)("h3",x,[(0,l.createVNode)(S,{k:"capi.provider.cloudCredential.title"})]),r.credentialRequired?(0,l.createCommentVNode)("",!0):((0,l.openBlock)(),(0,l.createElementBlock)("div",B,[(0,l.createVNode)($,{value:r.useCredential,"onUpdate:value":a[12]||(a[12]=e=>r.useCredential=e),name:"credential-toggle","on-label":e.t("capi.provider.cloudCredential.toggle",{provider:s.providerDisplayName})},null,8,["value","on-label"])])),r.useCredential?((0,l.openBlock)(),(0,l.createBlock)(D,{key:1,value:s.rancherCloudCredentialNamespaceName,mode:t.mode,provider:r.credentialComponent,cancel:s.cancelCredential,"showing-form":!1,class:"credential","onUpdate:value":a[13]||(a[13]=a=>e.$emit("update:value",{k:"spec.credentials.rancherCloudCredentialNamespaceName",val:a}))},null,8,["value","mode","provider","cancel"])):(0,l.createCommentVNode)("",!0)])):(0,l.createCommentVNode)("",!0)])),_:2},[s.waitingForCredential&&r.useCredential?{name:"form-footer",fn:(0,l.withCtx)((()=>[a[15]||(a[15]=(0,l.createElementVNode)("div",null,null,-1))])),key:"0"}:void 0]),1032,["mode","validation-passed","resource","errors","done-route","apply-hooks","onDone","onFinish","onCancel"]))}var P=t(65359),A=t(68851),O=t(35664),$=t(29822),D=t(47841),T=t(77651),R=t(91578),_=t(92043),L=t(76978),U=t(60046),M=t(55424),F=t(52715),I=t(87524),q=t(46295),j=t(76777),G=t(88339),Y=t(13089);const H={clusterResourceSet:!0,clusterTopology:!0,machinePool:!0},z={},K={name:"",type:"infrastructure",configSecret:{name:""},credentials:{rancherCloudCredentialNamespaceName:""}},Z={name:"",type:"infrastructure",configSecret:{name:""},credentials:{rancherCloudCredentialNamespaceName:""},fetchConfig:{url:""}},W=["infrastructure","bootstrap","controlPlane","addon","ipam","runtimeextension","core"],Q="custom";var X={name:"ProviderConfig",components:{CruResource:s.A,Loading:$.A,NameNsDescription:U.A,SelectCredential:D.A,Checkbox:R.A,KeyValue:M.A,LabeledInput:F.A,LabeledSelect:I.A,Banner:q.A,ToggleSwitch:j.j},mixins:[r.A,T.A],emits:["update:value"],props:{mode:{type:String,required:!0},value:{type:Object,required:!0},provider:{type:String,required:!0},category:{type:String,default:"infrastructure"}},beforeMount(){this.getDependencies().then((e=>{this.allNamespaces=e.namespaces||[],this.coreProviderSecret=e.coreProviderSecret||{},this.initSpecs(),this.loading=!1})).catch((e=>{this.errors.push(e),this.initSpecs(),this.loading=!1}))},data(){const e=this.provider,a=d.MA.find((a=>a.name===e))||{disabled:!1,id:"0"};return{loading:!0,fvFormRuleSets:[{path:"metadata.name",rules:["name"]},{path:"spec.version",rules:["version"]},{path:"spec.fetchConfig.url",rules:["url"]}],allNamespaces:[],credentialComponent:a?.credential,useCredential:!!a?.credentialRequired||this.mode===i.G5&&!!this.value?.spec?.credentials?.rancherCloudCredentialNamespaceName,credentialRequired:a?.credentialRequired,defaultNamespace:a?.ns}},watch:{useCredential(e){e||this.credentialRequired||(this.value.spec.credentials.rancherCloudCredentialNamespaceName="")}},computed:{...(0,P.L8)(["namespaces"]),fvExtraRules(){return{name:(0,Y.Vd)(this.$store.getters["i18n/t"]),version:(0,Y.wU)(this.$store.getters["i18n/t"]),url:(0,Y.IF)(this.$store.getters["i18n/t"])}},typeOptions(){return W.map((e=>({label:this.t(`capi.provider.type.${e}.label`),value:e})))},isEdit(){return this.mode===i.G5},isCreate(){return this.mode===i.YQ},hasFeatures(){return!!this.value?.spec?.features},hasVariables(){return!!this.value?.spec?.variables},isCustom(){return this.provider===Q},shouldShowBanner(){return this.isEdit&&(this.hasFeatures||this.hasVariables)},waitingForCredential(){return this.credentialComponent&&!this.value?.spec?.credentials?.rancherCloudCredentialNamespaceName},rancherCloudCredentialNamespaceName(){return this.value.spec?.credentials?.rancherCloudCredentialNamespaceName||""},providerDisplayName(){return this.t(`capi.provider.providerDisplayNames.${this.provider}`)||this.provider}},methods:{initSpecs(){if(!this.value.spec){const e=this.getSpecFromCoreSecret();this.provider!==Q?((0,L.hZ)(this.value,"spec",{...(0,L.o8)(K),...e}),(0,L.hZ)(this.value.spec,"type",this.category),(0,L.hZ)(this.value.metadata,"name",this.provider),(0,L.hZ)(this.value.metadata,"namespace",this.defaultNamespace)):(0,L.hZ)(this.value,"spec",{...(0,L.o8)(Z),...e})}this.isCreate&&!this.value.spec.configSecret?.name&&(0,L.hZ)(this.value.spec.configSecret,"name",this.generateName(this.provider))},getSpecFromCoreSecret(){const e=this.coreProviderSecret?.data;if(e){const a=["EXP_CLUSTER_RESOURCE_SET","CLUSTER_TOPOLOGY","EXP_MACHINE_POOL"],t=(0,L.o8)(e);return a.forEach((e=>{delete t[e]})),{features:{clusterResourceSet:"dHJ1ZQ=="===e.EXP_CLUSTER_RESOURCE_SET,clusterTopology:"dHJ1ZQ=="===e.CLUSTER_TOPOLOGY,machinePool:"dHJ1ZQ=="===e.EXP_MACHINE_POOL},variables:t}}return{features:(0,L.o8)(H),variables:(0,L.o8)(z)}},generateName(e){return e?`${e}-credentials-${(0,_.vx)(5).toLowerCase()}`:void 0},async getDependencies(){const e=this.$store.getters["currentStore"](O.CU),{$store:a}=this,t={namespaces:a.dispatch(`${e}/findAll`,{type:O.CU}),coreProviderSecret:a.dispatch("management/find",{type:O.bB,id:`${d.Ch}/${d.s7}`,opt:{watch:!1,force:!0}})};return await(0,G.kR)(t)},async saveOverride(e){if(this.errors&&(0,A.IU)(this.errors),this.$refs.providercruresource)try{await this.$refs.providercruresource.createNamespaceIfNeeded()}catch(a){this.errors.push(a.message),e(!1)}this.useCredential||this.value.spec?.credentials?.rancherCloudCredentialNamespaceName||(this.value.spec.credentials=null),""===this.value?.spec?.version&&delete this.value.spec.version;try{await this.save(e,null)}catch(a){this.errors.push(a),e(!1)}},cancelCredential(){this.credentialRequired?this.$refs.providercruresource&&this.$refs.providercruresource.emitOrRoute():this.useCredential=!1}}},J=(t(38456),t(47433));const ee=(0,J.A)(X,[["render",S],["__scopeId","data-v-9b6a5998"]]);var ae=ee,te=t(74302);const le={infrastructure:1,bootstrap:2,controlPlane:3,custom:4},oe="custom";var re={name:"CreateProvider",components:{CruResource:s.A,SelectIconGrid:n.A,ProviderConfig:ae},mixins:[r.A],emits:["set-subtype","update:value"],props:{value:{type:Object,default:null},componentTestid:{type:String,default:"capi-provider-create"}},async beforeMount(){this.capiProviders=await this.$store.dispatch("management/findAll",{type:d.qt.PROVIDER});const e=this.value.spec?.name||this.value.metadata?.name;e&&(this.value.spec?.fetchConfig&&!this.subTypes.find((({id:a})=>a===e))?this.selectType(oe):this.selectType(e))},data(){return{subType:null,capiProviders:[]}},computed:{subTypes(){const e=[],a=this.$store.getters;return d.MA?.forEach((e=>{const a=this.makeProviderId(e.name,e.type),t=e.disabled||this.enabledProviderTypes.includes(a);l(a,e.name,e.type,t)})),e;function l(l,o,r,s=!1){const n=a["i18n/withFallback"](`capi.provider.providerDisplayNames."${o}"`,null,o);let i;try{i=t(53588)(`./${o}.svg`)}catch(d){try{i=t(36283)(`./${o}.svg`)}catch(d){i=t(76251)}}const c={id:l,name:o,category:r,label:n,icon:i,disabled:s};e.push(c)}},groupedSubTypes(){const e={};for(const a of this.subTypes){const t=a.category;let l=e[t];l||(l={category:t,label:this.$store.getters["i18n/withFallback"](`capi.provider.type.${t}.label`,null,t),items:[],sort:le[t]},e[t]=l),l.items.push(a)}for(const a in e)e[a].items=(0,te.Ul)(e[a].items,"label");return(0,te.Ul)(Object.values(e),"sort")},enabledProviderTypes(){return this.capiProviders.reduce(((e,a)=>{const t=a?.spec?.name?a.spec.name:a?.metadata?.name,l=a?.spec?.type,o=this.makeProviderId(t,l);return e.includes(o)||t===oe||e.push(o),e}),[])}},methods:{set:L.hZ,makeProviderId(e,a){return`${e}-${a}`},clickedType(e){const a=e.name,t=e.category;this.$router?.applyQuery({[i.UA]:a,[c]:t}),this.selectType(a,t)},selectType(e,a){this.subType=e,this.category=a,this.$emit("set-subtype",this.$store.getters["i18n/withFallback"](`cluster.provider."${e}"`,null,e))}}};t(76639);const se=(0,J.A)(re,[["render",o]]);var ne=se},36700:function(e,a,t){var l=t(4796);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("37ea9510",l,!0,{sourceMap:!1,shadowMode:!1})},18145:function(e,a,t){var l=t(12289);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("6e62b75f",l,!0,{sourceMap:!1,shadowMode:!1})},42414:function(e,a,t){var l=t(29166);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("1968cab4",l,!0,{sourceMap:!1,shadowMode:!1})},73878:function(e,a,t){var l=t(76342);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("67f89c83",l,!0,{sourceMap:!1,shadowMode:!1})},13523:function(e,a,t){var l=t(94579);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("0638f1ab",l,!0,{sourceMap:!1,shadowMode:!1})},47985:function(e,a,t){var l=t(39697);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("1d7bb655",l,!0,{sourceMap:!1,shadowMode:!1})},39846:function(e,a,t){var l=t(54726);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("7231e2a4",l,!0,{sourceMap:!1,shadowMode:!1})},98695:function(e,a,t){var l=t(53799);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("226e6bca",l,!0,{sourceMap:!1,shadowMode:!1})},67066:function(e,a,t){var l=t(31546);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("5724823c",l,!0,{sourceMap:!1,shadowMode:!1})},67496:function(e,a,t){var l=t(65704);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("adcdcace",l,!0,{sourceMap:!1,shadowMode:!1})},11094:function(e,a,t){var l=t(12982);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("51bbd82d",l,!0,{sourceMap:!1,shadowMode:!1})},38456:function(e,a,t){var l=t(15256);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("3ad647b2",l,!0,{sourceMap:!1,shadowMode:!1})},76639:function(e,a,t){var l=t(52255);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=t(74825).A;o("312692b3",l,!0,{sourceMap:!1,shadowMode:!1})},53588:function(e,a,t){var l={"./aliyun-black.svg":87526,"./aliyun.svg":17180,"./aliyunecs-black.svg":75685,"./aliyunecs.svg":38683,"./amazonec2-black.svg":52212,"./amazonec2.svg":16598,"./amazoneks-black.svg":43881,"./amazoneks.svg":90287,"./aws.svg":59835,"./azure-black.svg":80895,"./azure.svg":60961,"./azuread-black.svg":81392,"./azuread.svg":45634,"./azureaks-black.svg":35894,"./azureaks.svg":40268,"./baidu-black.svg":71351,"./baidu.svg":47113,"./cloudca-black.svg":50309,"./cloudca.svg":23131,"./cloudscale-black.svg":51773,"./cloudscale.svg":86531,"./custom.svg":29181,"./digitalocean-black.svg":65988,"./digitalocean.svg":19110,"./equinix-black.svg":66335,"./equinix.svg":60705,"./exoscale.svg":12896,"./gcp.svg":2054,"./gke-black.svg":3405,"./gke.svg":61939,"./google.svg":32561,"./googlegke-black.svg":73562,"./googlegke.svg":97712,"./harvester.svg":53938,"./huaweicce-black.svg":91128,"./huaweicce.svg":40634,"./import.svg":28499,"./k3s-black.svg":35671,"./k3s.svg":85545,"./kubernetes-black.svg":27442,"./kubernetes.svg":9144,"./linode.svg":75553,"./linodelke-black.svg":96441,"./linodelke.svg":3199,"./local-cluster.svg":47600,"./minikube-black.svg":18152,"./minikube.svg":92746,"./nutanix.svg":70079,"./oci-black.svg":40097,"./oci.svg":46487,"./openstack-black.svg":57990,"./openstack.svg":53116,"./oracle.svg":88594,"./oracleoke-black.svg":56347,"./oracleoke.svg":9053,"./otc-black.svg":67294,"./otc.svg":69348,"./otccce.svg":24079,"./outscale.svg":72886,"./ovhcloudmks.svg":49619,"./ovhcloudpubliccloud.svg":54474,"./packet-black.svg":90742,"./packet.svg":48428,"./pinganyunecs-black.svg":49880,"./pinganyunecs.svg":58490,"./pnap-black.svg":59931,"./pnap.svg":31549,"./rackspace-black.svg":41511,"./rackspace.svg":65785,"./rke.svg":38102,"./rke2.svg":49560,"./sks.svg":46905,"./softlayer.svg":61883,"./tencenttke-black.svg":70963,"./tencenttke.svg":77701,"./vmwarevsphere-black.svg":26791,"./vmwarevsphere.svg":5337};function o(e){var a=r(e);return t(a)}function r(e){if(!t.o(l,e)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return l[e]}o.keys=function(){return Object.keys(l)},o.resolve=r,e.exports=o,o.id=53588},36283:function(e,a,t){var l={"./docker.svg":17743,"./kubeadm.svg":22472,"./vsphere-black.svg":49038,"./vsphere.svg":37652};function o(e){var a=r(e);return t(a)}function r(e){if(!t.o(l,e)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return l[e]}o.keys=function(){return Object.keys(l)},o.resolve=r,e.exports=o,o.id=36283},17743:function(e,a,t){"use strict";e.exports=t.p+"img/docker.921780fa.svg"},22472:function(e,a,t){"use strict";e.exports=t.p+"img/kubeadm.4ae3bc44.svg"},49038:function(e,a,t){"use strict";e.exports=t.p+"img/vsphere-black.454d68ed.svg"},37652:function(e,a,t){"use strict";e.exports=t.p+"img/vsphere.94d59db3.svg"}}]);
//# sourceMappingURL=capi-0.8.3-rc2.umd.min.edit.js.map